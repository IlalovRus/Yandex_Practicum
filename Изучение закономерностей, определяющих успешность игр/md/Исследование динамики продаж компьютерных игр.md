# Исследование динамики продаж компьютерных игр

**Заказчик:**  
Интернет-магазин "Стримчик"   
**Описание проекта:**  
В нашем распоряжении исторические данные (до 2016 года) из открытых источников о продажах игр, оценки пользователей и экспертов, жарны и платформы (например, Xbox или PlayStation). Необходимо выявить  определяющие успешность игры закономерности. Это позволит сделать ставку на потенциально популярный продукт и спланировать рекламные кампании.   
**Описание данных:**  
- **name** — название игры;
- **platform** - платформа;
- **year_of_release** - год выпуска;
- **genre** - жанр игры;
- **na_sales** - продажи в Северной Америке (миллионы долларов);
- **eu_sales** - продажи в Европе (миллионы долларов);
- **jp_sales** - продажи в Японии (миллионы долларов);
- **other_sales** - продажи в других странах (миллионы долларов);
- **critic_score** - оценка критиков (максимум 100);
- **user_score** - оценка пользователей (максимум 10);
- **rating** - рейтинг от организации ESRB (англ. Entertainment Software Rating Board). Эта ассоциация определяет рейтинг компьютерных игр и присваивает им подходящую возрастную категорию.

**Импорт необходимых библиотек** 


```python
import numpy as np
import pandas as pd
import seaborn as sns
import re
import matplotlib
import matplotlib.pyplot as plt
import scipy.stats as st
import time
import warnings

warnings.filterwarnings('ignore')

# для парсинга
import requests
from bs4 import BeautifulSoup as BS
!pip install requests beautifulsoup4 lxml
```

    Defaulting to user installation because normal site-packages is not writeable
    Requirement already satisfied: requests in e:\anaconda\envs\da_practicum_env\lib\site-packages (2.28.1)
    Requirement already satisfied: beautifulsoup4 in e:\anaconda\envs\da_practicum_env\lib\site-packages (4.9.3)
    Requirement already satisfied: lxml in c:\users\ryzen\appdata\roaming\python\python39\site-packages (4.9.2)
    Requirement already satisfied: certifi>=2017.4.17 in e:\anaconda\envs\da_practicum_env\lib\site-packages (from requests) (2022.12.7)
    Requirement already satisfied: charset-normalizer<3,>=2 in e:\anaconda\envs\da_practicum_env\lib\site-packages (from requests) (2.1.1)
    Requirement already satisfied: idna<4,>=2.5 in e:\anaconda\envs\da_practicum_env\lib\site-packages (from requests) (3.4)
    Requirement already satisfied: urllib3<1.27,>=1.21.1 in e:\anaconda\envs\da_practicum_env\lib\site-packages (from requests) (1.26.13)
    Requirement already satisfied: soupsieve>1.2 in e:\anaconda\envs\da_practicum_env\lib\site-packages (from beautifulsoup4) (2.3.2.post1)
    

**Функция для парсинга даты релиза игры**


```python
def get_date_release(row):
    title = row['name']
    print('Название игры: ', title)
    title = (title.lower()          
             .replace(':', '')      
             .replace('.', '')
             .replace('\'', '')
             .replace('!', '')
             .replace(' ', '-')
            )
    try:
        if row['platform'] == 'GB':
            url = 'https://www.mobygames.com/game/gameboy/' + title
        elif row['platform'] == 'DS':
            url = 'https://www.mobygames.com/game/nintendo-ds/' + title
        elif row['platform'] == 'X360':
            url = 'https://www.mobygames.com/game/xbox360/' + title
        elif row['platform'] == 'GBA':
            url = 'https://www.mobygames.com/game/gameboy-advance/' + title
        elif row['platform'] == 'PS':
            url = 'https://www.mobygames.com/game/playstation/' + title
        elif row['platform'] == 'XB':
            url = 'https://www.mobygames.com/game/xbox/' + title
        elif row['platform'] == '2600':
            url = 'https://www.mobygames.com/game/atari-2600/' + title
        elif row['platform'] == 'XOne':
            url = 'https://www.mobygames.com/game/xbox-one/' + title
        elif row['platform'] == 'WiiU':
            url = 'https://www.mobygames.com/game/wii-u/' + title
        elif row['platform'] == 'GC':
            url = 'https://www.mobygames.com/game/gamecube/' + title
        elif row['platform'] == 'PSV':
            url = 'https://www.mobygames.com/game/ps-vita/' + title
        elif row['platform'] == 'SAT':
            url = 'https://www.mobygames.com/game/sega-saturn/' + title
        elif row['platform'] == 'SCD':
            url = 'https://www.mobygames.com/game/sega-cd/' + title
        elif row['platform'] == 'TG16':
            url = 'https://www.mobygames.com/game/turbo-grafx/' + title
        elif row['platform'] == 'GG':
            url = 'https://www.mobygames.com/game/game-gear/' + title
        elif row['platform'] == 'GEN':
            url = 'https://www.mobygames.com/game/genesis/' + title
        elif row['platform'] == 'DC':
            url = 'https://www.mobygames.com/game/dreamcast/' + title
        elif row['platform'] == 'WS':
            url = 'https://www.mobygames.com/game/wonderswan/' + title
        elif row['platform'] == 'NG':
            url = 'https://www.mobygames.com/game/neo-geo/' + title
        elif row['platform'] == 'GG':
            url = 'https://www.mobygames.com/game/game-gear/' + title
        elif row['platform'] == 'PCFX':
            url = 'https://www.mobygames.com/game/pc-fx/' + title           
        else:
            url = 'https://www.mobygames.com/game/' + row['platform'] + '/' + title
        response = requests.get(url)
        soup = BS(response.text, 'lxml')
        date = int(soup.find(id='coreGameRelease').find_all('div')[5].text[-4:])
        print('Название игры для поискового запроса на сайте: ', title)
        print('Ссылка на сайт с информацией по игре: ', url)
        print('Дата выхода игры: ', date)
        print('')
        return int(date) 
    except:
        return np.nan        
```

**Функция для парсинга рейтинга игры**


```python
def get_rating(row):
    title = row['name']
    print(title)
    title = (title.lower()          
             .replace(':', '')     
             .replace('.', '')
             .replace('\'', '')
             .replace('!', '')
             .replace(' ', '-')
            )
    time.sleep(1)
    try:
        if row['platform'] == 'GB':
            url = 'https://www.mobygames.com/game/gameboy/' + title
        elif row['platform'] == 'DS':
            url = 'https://www.mobygames.com/game/nintendo-ds/' + title
        elif row['platform'] == 'X360':
            url = 'https://www.mobygames.com/game/xbox360/' + title
        elif row['platform'] == 'GBA':
            url = 'https://www.mobygames.com/game/gameboy-advance/' + title
        elif row['platform'] == 'PS':
            url = 'https://www.mobygames.com/game/playstation/' + title
        elif row['platform'] == 'XB':
            url = 'https://www.mobygames.com/game/xbox/' + title
        elif row['platform'] == '2600':
            url = 'https://www.mobygames.com/game/atari-2600/' + title
        elif row['platform'] == 'XOne':
            url = 'https://www.mobygames.com/game/xbox-one/' + title
        elif row['platform'] == 'WiiU':
            url = 'https://www.mobygames.com/game/wii-u/' + title
        elif row['platform'] == 'GC':
            url = 'https://www.mobygames.com/game/gamecube/' + title
        elif row['platform'] == 'PSV':
            url = 'https://www.mobygames.com/game/ps-vita/' + title
        elif row['platform'] == 'SAT':
            url = 'https://www.mobygames.com/game/sega-saturn/' + title
        elif row['platform'] == 'SCD':
            url = 'https://www.mobygames.com/game/sega-cd/' + title
        elif row['platform'] == 'TG16':
            url = 'https://www.mobygames.com/game/turbo-grafx/' + title
        elif row['platform'] == 'GG':
            url = 'https://www.mobygames.com/game/game-gear/' + title
        elif row['platform'] == 'GEN':
            url = 'https://www.mobygames.com/game/genesis/' + title
        elif row['platform'] == 'DC':
            url = 'https://www.mobygames.com/game/dreamcast/' + title
        elif row['platform'] == 'WS':
            url = 'https://www.mobygames.com/game/wonderswan/' + title
        elif row['platform'] == 'NG':
            url = 'https://www.mobygames.com/game/neo-geo/' + title
        elif row['platform'] == 'GG':
            url = 'https://www.mobygames.com/game/game-gear/' + title
        elif row['platform'] == 'PCFX':
            url = 'https://www.mobygames.com/game/pc-fx/' + title           
        else:
            url = 'https://www.mobygames.com/game/' + row['platform'] + '/' + title
        response = requests.get(url)
        soup = BS(response.text, 'lxml')
        rating_word = soup.find(id='coreGameGenre').find_all('div')[3].text
        if rating_word.lower() == 'early childhood':
            rating = 'EC'
        elif rating_word.lower() == 'everyone 10+':
            rating = 'E10+'
        elif rating_word.lower() == 'mature':
            rating = 'M'
        elif rating_word.lower() == 'rating pending':
            rating = 'RP'
        elif rating_word.lower() == 'everyone':
            rating = 'E'
        elif rating_word.lower() == 'teen':
            rating = 'T'
        elif rating_word.lower() == 'adults only':
            rating = 'AO'
        elif rating_word.lower() == 'kids to adults':
            rating = 'E'
        return rating
    except:
        return
```

**Функция для построения гистограмм**


```python
def print_bar(column_to_group, func, y='name', query=None):
    if query is None:
        df_to_bar = df.groupby(column_to_group)[y]
    else:
        df_to_bar = df.query(query).groupby(column_to_group)[y]
    if func == 'count':
        df_to_bar = df_to_bar.count()
        plot = df_to_bar.plot(kind='bar', y=y, ec='black', figsize=(15,5))
        if column_to_group == 'year_of_release':
            plot.set(xlabel = 'Годы',
                    ylabel = 'Количество игр, шт.',
                    title = 'Количество выпущенных игр по годам'
                    )
        for column in plot.patches:
            height = column.get_height()
            plot.text(x=column.get_x() + (column.get_width() / 2), y=height+10, s='{:.0f}'.format(height), ha='center', fontsize=7)
    elif func == 'sum':
        df_to_bar = df_to_bar.sum().sort_values()
        plot = df_to_bar.plot(kind='barh', y=y, ec='black', figsize=(15, 10))
        if column_to_group == 'platform':
            plot.set(xlabel = 'Продажи, в млн. копий',
                    ylabel = 'Платформы',
                    title = 'Продажи игр на различных платформах'
                    )
        for row in plot.patches:
            width = row.get_width()
            plot.text(x=width + 1, y=row.get_y() + (row.get_height() / 4), s='{:.0f}'.format(width), ha='left')
```

**Функция для построения графика по продаже игр в разные годы на разных консолях**


```python
def print_line_graph(platforms=None, query=None):
    legend = []
    if query is None:
        if platforms is not None:
            platforms = platforms
        else:
            platforms = df['platform'].unique().tolist()
    else:
        if platforms is not None:
            platforms = platforms
        else:    
            platforms = df.query(query)['platform'].unique().tolist()       
            
    for platform in platforms:
        if query is None:
            df_for_plot = df.query('platform == @platform')
        else:
            df_for_plot = df.query('platform == @platform').query(query)
        plot = df_for_plot.groupby('year_of_release')['total_sales'].sum().plot(kind='line', style='.-', figsize=(15,10))
        legend.append(platform)
        plt.legend(legend, bbox_to_anchor=(1.02, 1), loc='upper left')
        plot.set(xlabel = 'Годы',
                 ylabel = 'Продажи', 
                 title = 'Количество проданных копий игр на различных платформах, в млн.')      
```

## Открытие файла с данными и изучение общей информации

### Считаем данные из csv-файла в датафрейм и сохраним в переменную `df`


```python
try:
    df = pd.read_csv('/datasets/games.csv')
except:
    df = pd.read_csv('https://***/***/***.csv')
```

#### Выведем первые 15 строк датафрейма на экран


```python
df.head(15)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Platform</th>
      <th>Year_of_Release</th>
      <th>Genre</th>
      <th>NA_sales</th>
      <th>EU_sales</th>
      <th>JP_sales</th>
      <th>Other_sales</th>
      <th>Critic_Score</th>
      <th>User_Score</th>
      <th>Rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wii Sports</td>
      <td>Wii</td>
      <td>2006.0</td>
      <td>Sports</td>
      <td>41.36</td>
      <td>28.96</td>
      <td>3.77</td>
      <td>8.45</td>
      <td>76.0</td>
      <td>8</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Super Mario Bros.</td>
      <td>NES</td>
      <td>1985.0</td>
      <td>Platform</td>
      <td>29.08</td>
      <td>3.58</td>
      <td>6.81</td>
      <td>0.77</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mario Kart Wii</td>
      <td>Wii</td>
      <td>2008.0</td>
      <td>Racing</td>
      <td>15.68</td>
      <td>12.76</td>
      <td>3.79</td>
      <td>3.29</td>
      <td>82.0</td>
      <td>8.3</td>
      <td>E</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Wii Sports Resort</td>
      <td>Wii</td>
      <td>2009.0</td>
      <td>Sports</td>
      <td>15.61</td>
      <td>10.93</td>
      <td>3.28</td>
      <td>2.95</td>
      <td>80.0</td>
      <td>8</td>
      <td>E</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Pokemon Red/Pokemon Blue</td>
      <td>GB</td>
      <td>1996.0</td>
      <td>Role-Playing</td>
      <td>11.27</td>
      <td>8.89</td>
      <td>10.22</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tetris</td>
      <td>GB</td>
      <td>1989.0</td>
      <td>Puzzle</td>
      <td>23.20</td>
      <td>2.26</td>
      <td>4.22</td>
      <td>0.58</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>New Super Mario Bros.</td>
      <td>DS</td>
      <td>2006.0</td>
      <td>Platform</td>
      <td>11.28</td>
      <td>9.14</td>
      <td>6.50</td>
      <td>2.88</td>
      <td>89.0</td>
      <td>8.5</td>
      <td>E</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Wii Play</td>
      <td>Wii</td>
      <td>2006.0</td>
      <td>Misc</td>
      <td>13.96</td>
      <td>9.18</td>
      <td>2.93</td>
      <td>2.84</td>
      <td>58.0</td>
      <td>6.6</td>
      <td>E</td>
    </tr>
    <tr>
      <th>8</th>
      <td>New Super Mario Bros. Wii</td>
      <td>Wii</td>
      <td>2009.0</td>
      <td>Platform</td>
      <td>14.44</td>
      <td>6.94</td>
      <td>4.70</td>
      <td>2.24</td>
      <td>87.0</td>
      <td>8.4</td>
      <td>E</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Duck Hunt</td>
      <td>NES</td>
      <td>1984.0</td>
      <td>Shooter</td>
      <td>26.93</td>
      <td>0.63</td>
      <td>0.28</td>
      <td>0.47</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Nintendogs</td>
      <td>DS</td>
      <td>2005.0</td>
      <td>Simulation</td>
      <td>9.05</td>
      <td>10.95</td>
      <td>1.93</td>
      <td>2.74</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Mario Kart DS</td>
      <td>DS</td>
      <td>2005.0</td>
      <td>Racing</td>
      <td>9.71</td>
      <td>7.47</td>
      <td>4.13</td>
      <td>1.90</td>
      <td>91.0</td>
      <td>8.6</td>
      <td>E</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Pokemon Gold/Pokemon Silver</td>
      <td>GB</td>
      <td>1999.0</td>
      <td>Role-Playing</td>
      <td>9.00</td>
      <td>6.18</td>
      <td>7.20</td>
      <td>0.71</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Wii Fit</td>
      <td>Wii</td>
      <td>2007.0</td>
      <td>Sports</td>
      <td>8.92</td>
      <td>8.03</td>
      <td>3.60</td>
      <td>2.15</td>
      <td>80.0</td>
      <td>7.7</td>
      <td>E</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Kinect Adventures!</td>
      <td>X360</td>
      <td>2010.0</td>
      <td>Misc</td>
      <td>15.00</td>
      <td>4.89</td>
      <td>0.24</td>
      <td>1.69</td>
      <td>61.0</td>
      <td>6.3</td>
      <td>E</td>
    </tr>
  </tbody>
</table>
</div>



### Выведем основную информацию о датафрейме с помощью методов `info()` и `describe()`

#### С помощью `info()`


```python
df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 16715 entries, 0 to 16714
    Data columns (total 11 columns):
     #   Column           Non-Null Count  Dtype  
    ---  ------           --------------  -----  
     0   Name             16713 non-null  object 
     1   Platform         16715 non-null  object 
     2   Year_of_Release  16446 non-null  float64
     3   Genre            16713 non-null  object 
     4   NA_sales         16715 non-null  float64
     5   EU_sales         16715 non-null  float64
     6   JP_sales         16715 non-null  float64
     7   Other_sales      16715 non-null  float64
     8   Critic_Score     8137 non-null   float64
     9   User_Score       10014 non-null  object 
     10  Rating           9949 non-null   object 
    dtypes: float64(6), object(5)
    memory usage: 1.4+ MB
    

**В датафрейме собрана информация по 16 715 играм.  
Всего лишь в 3 из 11 столбцов довольно много пропусков.  
Для столбцов `year_of_release` и `user_score` некорректно выбран тип данных: в первом случае `float` необходимо заменить на `int`, поскольку летоисчисление ведется в целых, а не вещественных числах, а во втором случае `object` заменим на `float`, так как пользовательские оценки - отличный критерий для принятия решения об успешности и популярности игры (в отличие от оценок ангажированных критиков), поэтому, для того, чтобы иметь возможность работать и обрабатывать эти данные, необходимо представить их в виде чисел.  
Также приведем все названия столбцов к нижнему регистру.**  

#### С помощью `describe()`


```python
df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year_of_Release</th>
      <th>NA_sales</th>
      <th>EU_sales</th>
      <th>JP_sales</th>
      <th>Other_sales</th>
      <th>Critic_Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>16446.000000</td>
      <td>16715.000000</td>
      <td>16715.000000</td>
      <td>16715.000000</td>
      <td>16715.000000</td>
      <td>8137.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2006.484616</td>
      <td>0.263377</td>
      <td>0.145060</td>
      <td>0.077617</td>
      <td>0.047342</td>
      <td>68.967679</td>
    </tr>
    <tr>
      <th>std</th>
      <td>5.877050</td>
      <td>0.813604</td>
      <td>0.503339</td>
      <td>0.308853</td>
      <td>0.186731</td>
      <td>13.938165</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1980.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>13.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2003.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>60.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2007.000000</td>
      <td>0.080000</td>
      <td>0.020000</td>
      <td>0.000000</td>
      <td>0.010000</td>
      <td>71.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2010.000000</td>
      <td>0.240000</td>
      <td>0.110000</td>
      <td>0.040000</td>
      <td>0.030000</td>
      <td>79.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2016.000000</td>
      <td>41.360000</td>
      <td>28.960000</td>
      <td>10.220000</td>
      <td>10.570000</td>
      <td>98.000000</td>
    </tr>
  </tbody>
</table>
</div>



**Пока что смущает такой сильный разброс в датах релизов игр: промежуток в 36 лет выглядит не очень репрезентативным, поскольку за это время сменилось не одно поколение консолей, графика и сюжеты в играх успели совершить неимоверный скачок вперед, даже успело смениться поколение самих геймеров с их вкусовыми предпочтениями и запросами, поэтому не факт, что игра, которая была хитом в 80-х, 90-х или даже в 00-х, сейчас будет пользоваться таким же успехом.**  

**Также пока непонятны нулевые оценки игр. Разберемся с этим на предобработке.**

## Предобработка данных

### Замена названий столбцов (приведение к нижнему регистру)


```python
df.columns = df.columns.str.lower()
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
      <th>genre</th>
      <th>na_sales</th>
      <th>eu_sales</th>
      <th>jp_sales</th>
      <th>other_sales</th>
      <th>critic_score</th>
      <th>user_score</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wii Sports</td>
      <td>Wii</td>
      <td>2006.0</td>
      <td>Sports</td>
      <td>41.36</td>
      <td>28.96</td>
      <td>3.77</td>
      <td>8.45</td>
      <td>76.0</td>
      <td>8</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Super Mario Bros.</td>
      <td>NES</td>
      <td>1985.0</td>
      <td>Platform</td>
      <td>29.08</td>
      <td>3.58</td>
      <td>6.81</td>
      <td>0.77</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mario Kart Wii</td>
      <td>Wii</td>
      <td>2008.0</td>
      <td>Racing</td>
      <td>15.68</td>
      <td>12.76</td>
      <td>3.79</td>
      <td>3.29</td>
      <td>82.0</td>
      <td>8.3</td>
      <td>E</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Wii Sports Resort</td>
      <td>Wii</td>
      <td>2009.0</td>
      <td>Sports</td>
      <td>15.61</td>
      <td>10.93</td>
      <td>3.28</td>
      <td>2.95</td>
      <td>80.0</td>
      <td>8</td>
      <td>E</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Pokemon Red/Pokemon Blue</td>
      <td>GB</td>
      <td>1996.0</td>
      <td>Role-Playing</td>
      <td>11.27</td>
      <td>8.89</td>
      <td>10.22</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



### Преобразование данных в нужные типы


```python
df.dtypes
```




    name                object
    platform            object
    year_of_release    float64
    genre               object
    na_sales           float64
    eu_sales           float64
    jp_sales           float64
    other_sales        float64
    critic_score       float64
    user_score          object
    rating              object
    dtype: object




```python
df['year_of_release'].unique()
```




    array([2006., 1985., 2008., 2009., 1996., 1989., 1984., 2005., 1999.,
           2007., 2010., 2013., 2004., 1990., 1988., 2002., 2001., 2011.,
           1998., 2015., 2012., 2014., 1992., 1997., 1993., 1994., 1982.,
           2016., 2003., 1986., 2000.,   nan, 1995., 1991., 1981., 1987.,
           1980., 1983.])



Поскольку в столбце есть пропуски, замену типа данных произведем не на `int`, а на `Int64` (позволяет заменять тип данных, когда в столбце есть пропуски). 


```python
# заменяем тип данных в столбце 'year_of_release'
df['year_of_release'] = df['year_of_release'].astype('Int64')
```


```python
df['user_score'].unique()
```




    array(['8', nan, '8.3', '8.5', '6.6', '8.4', '8.6', '7.7', '6.3', '7.4',
           '8.2', '9', '7.9', '8.1', '8.7', '7.1', '3.4', '5.3', '4.8', '3.2',
           '8.9', '6.4', '7.8', '7.5', '2.6', '7.2', '9.2', '7', '7.3', '4.3',
           '7.6', '5.7', '5', '9.1', '6.5', 'tbd', '8.8', '6.9', '9.4', '6.8',
           '6.1', '6.7', '5.4', '4', '4.9', '4.5', '9.3', '6.2', '4.2', '6',
           '3.7', '4.1', '5.8', '5.6', '5.5', '4.4', '4.6', '5.9', '3.9',
           '3.1', '2.9', '5.2', '3.3', '4.7', '5.1', '3.5', '2.5', '1.9', '3',
           '2.7', '2.2', '2', '9.5', '2.1', '3.6', '2.8', '1.8', '3.8', '0',
           '1.6', '9.6', '2.4', '1.7', '1.1', '0.3', '1.5', '0.7', '1.2',
           '2.3', '0.5', '1.3', '0.2', '0.6', '1.4', '0.9', '1', '9.7'],
          dtype=object)



В столбце есть [аббревиатура TBD](https://mobilradio.ru/information/vocabulary/tbd.htm), которая говорит о том, что у игры еще нет рейтинга пользователей. Такое возможно, если игра еще не вышла (можно только оформить предзаказ) или у игры еще недостаточно отзывов, чтобы указывать среднюю пользовательскую оценку. Также в наше время агрегаторы оценок практинуют такую "фичу": пользователи не могут выставлять оценки в первые дни продажи игры, дабы не портить ей эти самые продажи (нет, чтобы игры кодить нормально научиться...)  
Прежде чем изменять тип данных в столбце, необходимо понять, что делать с этой аббревиатурой. Заменять на нули, среднее арифметическое или медиану по жанру или просто дублировать оценку критиков некорректно, поскольку это не будет отражать даже примерного отношения пользователей к игре: нули - вообще несправедливо; "средние" - нет корреляции между различными играми одного жанра; дублирование оценки - мнение критиков и игроков зачастую не совпадают чуть меньше, чем полностью.  
Посмотрим, как много таких строк, и есть ли в них что-то важное для дальнейшего исследования.


```python
print('Строк с аббревиатурой TBD: ' + str(df[df['user_score'] == 'tbd']['user_score'].count()))
df[df['user_score'] == 'tbd'].head(25)
```

    Строк с аббревиатурой TBD: 2424
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
      <th>genre</th>
      <th>na_sales</th>
      <th>eu_sales</th>
      <th>jp_sales</th>
      <th>other_sales</th>
      <th>critic_score</th>
      <th>user_score</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>119</th>
      <td>Zumba Fitness</td>
      <td>Wii</td>
      <td>2010</td>
      <td>Sports</td>
      <td>3.45</td>
      <td>2.59</td>
      <td>0.00</td>
      <td>0.66</td>
      <td>NaN</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>301</th>
      <td>Namco Museum: 50th Anniversary</td>
      <td>PS2</td>
      <td>2005</td>
      <td>Misc</td>
      <td>2.08</td>
      <td>1.35</td>
      <td>0.00</td>
      <td>0.54</td>
      <td>61.0</td>
      <td>tbd</td>
      <td>E10+</td>
    </tr>
    <tr>
      <th>520</th>
      <td>Zumba Fitness 2</td>
      <td>Wii</td>
      <td>2011</td>
      <td>Sports</td>
      <td>1.51</td>
      <td>1.03</td>
      <td>0.00</td>
      <td>0.27</td>
      <td>NaN</td>
      <td>tbd</td>
      <td>T</td>
    </tr>
    <tr>
      <th>645</th>
      <td>uDraw Studio</td>
      <td>Wii</td>
      <td>2010</td>
      <td>Misc</td>
      <td>1.65</td>
      <td>0.57</td>
      <td>0.00</td>
      <td>0.20</td>
      <td>71.0</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>657</th>
      <td>Frogger's Adventures: Temple of the Frog</td>
      <td>GBA</td>
      <td>&lt;NA&gt;</td>
      <td>Adventure</td>
      <td>2.15</td>
      <td>0.18</td>
      <td>0.00</td>
      <td>0.07</td>
      <td>73.0</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>718</th>
      <td>Just Dance Kids</td>
      <td>Wii</td>
      <td>2010</td>
      <td>Misc</td>
      <td>1.52</td>
      <td>0.54</td>
      <td>0.00</td>
      <td>0.18</td>
      <td>NaN</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>726</th>
      <td>Dance Dance Revolution X2</td>
      <td>PS2</td>
      <td>2009</td>
      <td>Simulation</td>
      <td>1.09</td>
      <td>0.85</td>
      <td>0.00</td>
      <td>0.28</td>
      <td>NaN</td>
      <td>tbd</td>
      <td>E10+</td>
    </tr>
    <tr>
      <th>821</th>
      <td>The Incredibles</td>
      <td>GBA</td>
      <td>2004</td>
      <td>Action</td>
      <td>1.15</td>
      <td>0.77</td>
      <td>0.04</td>
      <td>0.10</td>
      <td>55.0</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>881</th>
      <td>Who wants to be a millionaire</td>
      <td>PC</td>
      <td>1999</td>
      <td>Misc</td>
      <td>1.94</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1047</th>
      <td>Tetris Worlds</td>
      <td>GBA</td>
      <td>2001</td>
      <td>Puzzle</td>
      <td>1.25</td>
      <td>0.39</td>
      <td>0.00</td>
      <td>0.06</td>
      <td>65.0</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1048</th>
      <td>Imagine: Teacher</td>
      <td>DS</td>
      <td>2008</td>
      <td>Simulation</td>
      <td>0.70</td>
      <td>0.82</td>
      <td>0.00</td>
      <td>0.19</td>
      <td>NaN</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Personal Trainer: Math</td>
      <td>DS</td>
      <td>2007</td>
      <td>Puzzle</td>
      <td>0.48</td>
      <td>1.12</td>
      <td>0.00</td>
      <td>0.08</td>
      <td>63.0</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1070</th>
      <td>Game Party 3</td>
      <td>Wii</td>
      <td>2009</td>
      <td>Puzzle</td>
      <td>1.40</td>
      <td>0.16</td>
      <td>0.00</td>
      <td>0.12</td>
      <td>37.0</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1089</th>
      <td>Monsters, Inc.</td>
      <td>GBA</td>
      <td>2001</td>
      <td>Adventure</td>
      <td>0.59</td>
      <td>0.95</td>
      <td>0.03</td>
      <td>0.10</td>
      <td>NaN</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1151</th>
      <td>SpongeBob's Atlantis SquarePantis</td>
      <td>DS</td>
      <td>2007</td>
      <td>Action</td>
      <td>1.49</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.11</td>
      <td>64.0</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1199</th>
      <td>MySims Kingdom</td>
      <td>DS</td>
      <td>2008</td>
      <td>Simulation</td>
      <td>0.80</td>
      <td>0.59</td>
      <td>0.01</td>
      <td>0.16</td>
      <td>58.0</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1210</th>
      <td>Moshi Monsters: Moshling Zoo</td>
      <td>DS</td>
      <td>2011</td>
      <td>Misc</td>
      <td>0.37</td>
      <td>0.96</td>
      <td>0.00</td>
      <td>0.21</td>
      <td>NaN</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1284</th>
      <td>Disney Sing It: Pop Hits</td>
      <td>Wii</td>
      <td>2009</td>
      <td>Misc</td>
      <td>1.07</td>
      <td>0.28</td>
      <td>0.00</td>
      <td>0.13</td>
      <td>NaN</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1291</th>
      <td>Imagine: Master Chef</td>
      <td>DS</td>
      <td>2007</td>
      <td>Simulation</td>
      <td>0.39</td>
      <td>0.91</td>
      <td>0.00</td>
      <td>0.17</td>
      <td>NaN</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1292</th>
      <td>Disney Princess</td>
      <td>GBA</td>
      <td>2003</td>
      <td>Platform</td>
      <td>1.04</td>
      <td>0.37</td>
      <td>0.00</td>
      <td>0.06</td>
      <td>NaN</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1298</th>
      <td>The SpongeBob SquarePants Movie</td>
      <td>GBA</td>
      <td>2004</td>
      <td>Platform</td>
      <td>1.02</td>
      <td>0.38</td>
      <td>0.00</td>
      <td>0.06</td>
      <td>NaN</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1300</th>
      <td>Midway Arcade Treasures</td>
      <td>PS2</td>
      <td>2003</td>
      <td>Misc</td>
      <td>0.72</td>
      <td>0.56</td>
      <td>0.00</td>
      <td>0.19</td>
      <td>76.0</td>
      <td>tbd</td>
      <td>T</td>
    </tr>
    <tr>
      <th>1309</th>
      <td>Wall-E</td>
      <td>DS</td>
      <td>2008</td>
      <td>Platform</td>
      <td>0.46</td>
      <td>0.82</td>
      <td>0.00</td>
      <td>0.17</td>
      <td>54.0</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1341</th>
      <td>Disney Princess: Magical Jewels</td>
      <td>DS</td>
      <td>2007</td>
      <td>Adventure</td>
      <td>1.12</td>
      <td>0.19</td>
      <td>0.00</td>
      <td>0.11</td>
      <td>NaN</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1367</th>
      <td>Hello Kitty Party</td>
      <td>DS</td>
      <td>2007</td>
      <td>Misc</td>
      <td>0.78</td>
      <td>0.51</td>
      <td>0.00</td>
      <td>0.12</td>
      <td>NaN</td>
      <td>tbd</td>
      <td>E</td>
    </tr>
  </tbody>
</table>
</div>



Около 15% всего датафрейма. Не хочется терять столько данных. По своей сути аббревиатура `tbd` в рамках нашего исследования равносильна отсутствию рейтинга у игры, поэтому заменим ее на `NaN`.


```python
# заменим 'tbd' на NaN
df['user_score'] = df['user_score'].replace('tbd', np.NaN)
print('Строк с аббревиатурой TBD: ' + str(df[df['user_score'] == 'tbd']['user_score'].count()))
```

    Строк с аббревиатурой TBD: 0
    


```python
# изменим тип данных в столбце 'user_score'
df['user_score'] = pd.to_numeric(df['user_score'])
df.dtypes
```




    name                object
    platform            object
    year_of_release      Int64
    genre               object
    na_sales           float64
    eu_sales           float64
    jp_sales           float64
    other_sales        float64
    critic_score       float64
    user_score         float64
    rating              object
    dtype: object



### Обработка пропусков 


```python
df.isna().sum().sort_values(ascending=True)
```




    platform              0
    na_sales              0
    eu_sales              0
    jp_sales              0
    other_sales           0
    name                  2
    genre                 2
    year_of_release     269
    rating             6766
    critic_score       8578
    user_score         9125
    dtype: int64



- `name`: строк с пропуском в этом столбце мало и они не дают нам никакого представления о показателях конкретной игры (как ни странно, мы не знаем, что это за игра без названия = )), но все же эти строки имеют ценность для статистики по жанрам или годам выпуска игр, они входят в статистики продаж по регионам, поэтому, если пропущено только название, заменим пропуски значением `unknown`, иначе - удалим эти строки; 
- `genre`: пропусков всего 2, поэтому заполним их актуальными данными из интернета;
- `year_of_release`: попробуем спарсить год релиза игр с сайта-базы данных;  
<font color=blue>В процессе парсинга столкнулся с этим 👇: видимо к играм с одинаковым названием разрабы сайта просто дописывали всякие символы. Разумеется, при парсинге такое не учитывается. </font> 
![вот](http://dl4.joxi.net/drive/2023/02/01/0055/3022/3648462/62/7e1f9c0087.jpg)
- `rating`: будем парсить. Также рейтинг `K-A` попутно заменим на `E`, поскольку согласно [Википедии](https://ru.wikipedia.org/wiki/Entertainment_Software_Rating_Board) он был заменен;  
<font color=blue>В процессе парсинга столкнулся с тем, что практически у всех старых игр не проставлен рейтинг, поскольку организация, выдающая рейтинг, была основана лишь в 1994 году. Более ранним играм рейтинг выдавать поленились, похоже. Подход к делу 5 из 5.</font>  
- `critic_score`: данные брались с сайта [**metacritic**](https://www.metacritic.com), но сейчас проблемно зайти на него без vpn;
- `user_score`: тут проблема. Скорее всего данные также брались с metacritic, но, если критики, как правило, не возвращаются к уже оцененным играм, то рейтинг пользователей не статичная величина, и в 2023 году он совсем не такой, каким был в 2016 или раньше. Смешивать их будет не совсем правильно.

<font color=red>Если 269 значений парсились относительно быстро, то 5000+ строк парсятся по несколько часов. Кажется, эту затею придется оставить. Проверим на 1-2 строчках, что это работает, но оставим пропуски как есть.</font>

#### Столбец `name`


```python
df[df['name'].isna()]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
      <th>genre</th>
      <th>na_sales</th>
      <th>eu_sales</th>
      <th>jp_sales</th>
      <th>other_sales</th>
      <th>critic_score</th>
      <th>user_score</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>659</th>
      <td>NaN</td>
      <td>GEN</td>
      <td>1993</td>
      <td>NaN</td>
      <td>1.78</td>
      <td>0.53</td>
      <td>0.00</td>
      <td>0.08</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>14244</th>
      <td>NaN</td>
      <td>GEN</td>
      <td>1993</td>
      <td>NaN</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.03</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



Два раритета 1993 года без жанра, без оценок, с какими-то незначительными продажами. Думаю, от отсутствия этих строк датафрейм не потеряет в информативности. 


```python
df = df.dropna(subset=['name'])
```

#### Столбец `genre`


```python
df[df['genre'].isna()]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
      <th>genre</th>
      <th>na_sales</th>
      <th>eu_sales</th>
      <th>jp_sales</th>
      <th>other_sales</th>
      <th>critic_score</th>
      <th>user_score</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>



Эти строки были удалены на предыдущем шаге. 

#### Столбец `year_of_release`


```python
df[df['year_of_release'].isna()].tail(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
      <th>genre</th>
      <th>na_sales</th>
      <th>eu_sales</th>
      <th>jp_sales</th>
      <th>other_sales</th>
      <th>critic_score</th>
      <th>user_score</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16277</th>
      <td>Homeworld Remastered Collection</td>
      <td>PC</td>
      <td>&lt;NA&gt;</td>
      <td>Strategy</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>86.0</td>
      <td>8.2</td>
      <td>E10+</td>
    </tr>
    <tr>
      <th>16288</th>
      <td>Shorts</td>
      <td>DS</td>
      <td>&lt;NA&gt;</td>
      <td>Platform</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>E10+</td>
    </tr>
    <tr>
      <th>16293</th>
      <td>AKB1/48: Idol to Guam de Koishitara...</td>
      <td>X360</td>
      <td>&lt;NA&gt;</td>
      <td>Misc</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16329</th>
      <td>Brothers in Arms: Furious 4</td>
      <td>X360</td>
      <td>&lt;NA&gt;</td>
      <td>Shooter</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>M</td>
    </tr>
    <tr>
      <th>16348</th>
      <td>Agarest Senki: Re-appearance</td>
      <td>PS3</td>
      <td>&lt;NA&gt;</td>
      <td>Role-Playing</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16373</th>
      <td>PDC World Championship Darts 2008</td>
      <td>PSP</td>
      <td>&lt;NA&gt;</td>
      <td>Sports</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>43.0</td>
      <td>NaN</td>
      <td>E10+</td>
    </tr>
    <tr>
      <th>16405</th>
      <td>Freaky Flyers</td>
      <td>GC</td>
      <td>&lt;NA&gt;</td>
      <td>Racing</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>69.0</td>
      <td>6.5</td>
      <td>T</td>
    </tr>
    <tr>
      <th>16448</th>
      <td>Inversion</td>
      <td>PC</td>
      <td>&lt;NA&gt;</td>
      <td>Shooter</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>59.0</td>
      <td>6.7</td>
      <td>M</td>
    </tr>
    <tr>
      <th>16458</th>
      <td>Hakuouki: Shinsengumi Kitan</td>
      <td>PS3</td>
      <td>&lt;NA&gt;</td>
      <td>Adventure</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16522</th>
      <td>Virtua Quest</td>
      <td>GC</td>
      <td>&lt;NA&gt;</td>
      <td>Role-Playing</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>55.0</td>
      <td>5.5</td>
      <td>T</td>
    </tr>
  </tbody>
</table>
</div>




```python
# создадим датафрейм с играми, у которых не указана дата релиза:
data_with_titles_without_release_date = df.loc[df['year_of_release'].isna()][['name', 'platform']]
data_with_titles_without_release_date
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>183</th>
      <td>Madden NFL 2004</td>
      <td>PS2</td>
    </tr>
    <tr>
      <th>377</th>
      <td>FIFA Soccer 2004</td>
      <td>PS2</td>
    </tr>
    <tr>
      <th>456</th>
      <td>LEGO Batman: The Videogame</td>
      <td>Wii</td>
    </tr>
    <tr>
      <th>475</th>
      <td>wwe Smackdown vs. Raw 2006</td>
      <td>PS2</td>
    </tr>
    <tr>
      <th>609</th>
      <td>Space Invaders</td>
      <td>2600</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>16373</th>
      <td>PDC World Championship Darts 2008</td>
      <td>PSP</td>
    </tr>
    <tr>
      <th>16405</th>
      <td>Freaky Flyers</td>
      <td>GC</td>
    </tr>
    <tr>
      <th>16448</th>
      <td>Inversion</td>
      <td>PC</td>
    </tr>
    <tr>
      <th>16458</th>
      <td>Hakuouki: Shinsengumi Kitan</td>
      <td>PS3</td>
    </tr>
    <tr>
      <th>16522</th>
      <td>Virtua Quest</td>
      <td>GC</td>
    </tr>
  </tbody>
</table>
<p>269 rows × 2 columns</p>
</div>




```python
data_with_titles_without_release_date['year_of_release'] = data_with_titles_without_release_date.apply(get_date_release, axis=1)

# это будет долго =) 
```

    Название игры:  Madden NFL 2004
    Название игры:  FIFA Soccer 2004
    Название игры:  LEGO Batman: The Videogame
    Название игры:  wwe Smackdown vs. Raw 2006
    Название игры:  Space Invaders
    Название игры:  Rock Band
    Название игры:  Frogger's Adventures: Temple of the Frog
    Название игры:  LEGO Indiana Jones: The Original Adventures
    Название игры:  Call of Duty 3
    Название игры:  Rock Band
    Название игры:  Call of Duty: Black Ops
    Название игры:  Rock Band
    Название игры:  Triple Play 99
    Название игры:  Adventure
    Название игры:  LEGO Batman: The Videogame
    Название игры:  Combat
    Название игры:  LEGO Harry Potter: Years 5-7
    Название игры:  NASCAR Thunder 2003
    Название игры:  Hitman 2: Silent Assassin
    Название игры:  Rock Band
    Название игры:  Legacy of Kain: Soul Reaver
    Название игры:  Donkey Kong Land III
    Название игры:  Air-Sea Battle
    Название игры:  Suikoden III
    Название игры:  LEGO Harry Potter: Years 5-7
    Название игры:  Wheel of Fortune
    Название игры:  Yakuza 4
    Название игры:  LEGO Harry Potter: Years 5-7
    Название игры:  Namco Museum
    Название игры:  Rhythm Heaven
    Название игры:  The Lord of the Rings: War in the North
    Название игры:  Madden NFL 07
    Название игры:  MLB SlugFest 20-03
    Название игры:  The Lord of the Rings: War in the North
    Название игры:  Shaun White Snowboarding
    Название игры:  PES 2009: Pro Evolution Soccer
    Название игры:  WarioWare: Twisted!
    Название игры:  Madden NFL 11
    Название игры:  Test Drive Unlimited 2
    Название игры:  The Chronicles of Narnia: The Lion, The Witch and The Wardrobe
    Название игры:  LEGO Harry Potter: Years 5-7
    Название игры:  Monster Hunter 2
    Название игры:  Metal Gear Solid 2: Substance
    Название игры:  Test Drive Unlimited 2
    Название игры:  Advance Wars: Days of Ruin
    Название игры:  The Golden Compass
    Название игры:  Madden NFL 06
    Название игры:  NASCAR: Dirt to Daytona
    Название игры:  Madden NFL 2002
    Название игры:  Def Jam: Fight for NY
    Название игры:  NBA Street Vol. 2
    Название игры:  Fishing Derby
    Название игры:  Wet
    Название игры:  Sonic the Hedgehog
    Название игры:  Karate
    Название игры:  Tiger Woods PGA Tour 07
    Название игры:  Circus Atari
    Название игры:  The Chronicles of Riddick: Escape from Butcher Bay
    Название игры:  Maze Craze: A Game of Cops 'n Robbers
    Название игры:  Silent Hill: Homecoming
    Название игры:  Super Breakout
    Название игры:  Robert Ludlum's The Bourne Conspiracy
    Название игры:  NHL Slapshot
    Название игры:  TERA
    Название игры:  NFL GameDay 2003
    Название игры:  LEGO Harry Potter: Years 5-7
    Название игры:  Harvest Moon: Save the Homeland
    Название игры:  Robert Ludlum's The Bourne Conspiracy
    Название игры:  Silent Hill: Homecoming
    Название игры:  Hangman
    Название игры:  The Golden Compass
    Название игры:  NBA Live 2003
    Название игры:  Cubix Robots for Everyone: Clash 'n' Bash
    Название игры:  Dragon Ball Z: Budokai Tenkaichi 2 (JP sales)
    Название игры:  Tropico 4
    Название игры:  Tomb Raider (2013)
    Название игры:  Bejeweled 3
    Название игры:  Custom Robo
    Название игры:  Final Fantasy XI
    Название игры:  Singularity
    Название игры:  Dragster
    Название игры:  All-Star Baseball 2005
    Название игры:  Star Wars Jedi Knight II: Jedi Outcast
    Название игры:  Slot Machine
    Название игры:  The Dukes of Hazzard II: Daisy Dukes It Out
    Название игры:  Harvest Moon: The Tale of Two Towns
    Название игры:  NBA Live 2003
    Название игры:  Shrek the Third
    Название игры:  Nicktoons: Battle for Volcano Island
    Название игры:  Haven: Call of the King
    Название игры:  Unreal Championship 2: The Liandri Conflict
    Название игры:  The Chronicles of Narnia: The Lion, The Witch and The Wardrobe
    Название игры:  Pac-Man Fever
    Название игры:  The Legend of Zelda: The Minish Cap(weekly JP sales)
    Название игры:  Indy 500
    Название игры:  Disgaea 3: Absence of Detention
    Название игры:  Flag Capture
    Название игры:  Gun
    Название игры:  Rock Revolution
    Название игры:  LEGO Harry Potter: Years 5-7
    Название игры:  College Hoops 2K6
    Название игры:  Jonah Lomu Rugby Challenge
    Название игры:  Mega Man X Collection
    Название игры:  BioShock 2
    Название игры:  Singularity
    Название игры:  Danganronpa: Trigger Happy Havoc
    Название игры:  Jet X20
    Название игры:  Tony Hawk's Downhill Jam
    Название игры:  Tribes: Aerial Assault
    Название игры:  Big Beach Sports 2
    Название игры:  LEGO Harry Potter: Years 5-7
    Название игры:  Yu Yu Hakusho: Dark Tournament
    Название игры:  Ghostbusters II
    Название игры:  Breakaway IV
    Название игры:  Robotech: Battlecry
    Название игры:  Move Fitness
    Название игры:  Valkyria Chronicles III: Unrecorded Chronicles
    Название игры:  DanceDanceRevolution II
    Название игры:  WRC: FIA World Rally Championship
    Название игры:  Famista 64
    Название игры:  Dead Space 3
    Название игры:  Test Drive Unlimited 2
    Название игры:  Pet Zombies
    Название игры:  Star Trek: Legacy
    Название игры:  Backbreaker
    Название игры:  Twisted Metal: Small Brawl
    Название игры:  Otomedius Excellent
    Название игры:  NBA Starting Five
    Название игры:  Teen Titans
    Название игры:  Trauma Team
    Название игры:  Backbreaker
    Название игры:  James Cameron's Dark Angel
    Название игры:  Sword of the Samurai
    Название игры:  Splatterhouse
    Название игры:  Alone in the Dark: The New Nightmare
    Название игры:  Vegas Party
    Название игры:  Jurassic Park: The Game
    Название игры:  Home Run
    Название игры:  eJay Clubworld
    Название игры:  All-Star Baseball 2005
    Название игры:  Bejeweled 3
    Название игры:  Our House Party!
    Название игры:  WCW Backstage Assault
    Название игры:  Bejeweled 3
    Название игры:  Disney's Cinderella: Magical Dreams
    Название игры:  Transworld Surf
    Название игры:  Street Fighter IV
    Название игры:  Nintendo Puzzle Collection
    Название игры:  Charm Girls Club: My Fashion Mall
    Название игры:  Record of Agarest War Zero
    Название игры:  Rocksmith
    Название игры:  Super Robot Wars OG Saga: Masou Kishin II - Revelation of Evil God
    Название игры:  Saru! Get You! Million Monkeys
    Название игры:  Street Hoops
    Название игры:  WRC: FIA World Rally Championship
    Название игры:  Godzilla: Destroy All Monsters Melee
    Название игры:  The Daring Game for Girls
    Название игры:  Major League Baseball 2K6
    Название игры:  Star Trek: Conquest
    Название игры:  GiFTPiA
    Название игры:  Happy Feet Two
    Название игры:  Disney's Chicken Little: Ace In Action
    Название игры:  Atsumare! Power Pro Kun no DS Koushien
    Название игры:  My Healthy Cooking Coach
    Название игры:  Happy Feet Two
    Название игры:  Luminous Arc 2 (JP sales)
    Название игры:  Happy Feet Two
    Название игры:  Egg Monster Hero
    Название игры:  The Daring Game for Girls
    Название игры:  Demon Chaos
    Название игры:  Samurai Shodown Anthology
    Название игры:  Action Man-Operation Extreme
    Название игры:  Super Puzzle Fighter II
    Название игры:  Charm Girls Club: My Fashion Show
    Название игры:  Face Racers: Photo Finish
    Название игры:  Zero: Tsukihami no Kamen
    Название игры:  The Hidden
    Название игры:  Get Fit with Mel B
    Название игры:  Rock Revolution
    Название игры:  Happy Feet Two
    Название игры:  Mega Man Battle Network: Operation Shooting Star
    Название игры:  Smashing Drive
    Название игры:  Port Royale 3
    Название игры:  Dream Trigger 3D
    Название игры:  Dead Island: Riptide
    Название игры:  Yoostar on MTV
    Название игры:  Tornado
    Название игры:  McFarlane's Evil Prophecy
    Название игры:  Drake of the 99 Dragons
    Название игры:  Build-A-Bear Workshop: Friendship Valley
    Название игры:  Rayman Arena
    Название игры:  Port Royale 3
    Название игры:  National Geographic Challenge!
    Название игры:  Alex Rider: Stormbreaker
    Название игры:  Chou Soujuu Mecha MG
    Название игры:  Prinny: Can I Really Be The Hero? (US sales)
    Название игры:  Combat Elite: WWII Paratroopers
    Название игры:  Flip's Twisted World
    Название игры:  Mobile Ops: The One Year War
    Название игры:  Tom Clancy's Rainbow Six: Critical Hour
    Название игры:  Jewel Link Chronicles: Mountains of Madness
    Название игры:  Captain America: Super Soldier
    Название игры:  Mountain Bike Adrenaline
    Название игры:  Drill Dozer
    Название игры:  Captain America: Super Soldier
    Название игры:  GRID
    Название игры:  Tour de France 2011
    Название игры:  Reader Rabbit 2nd Grade
    Название игры:  Monster Hunter Frontier Online
    Название игры:  RollerCoaster Tycoon
    Название игры:  Battle vs. Chess
    Название игры:  The History Channel: Great Battles - Medieval
    Название игры:  Clockwork Empires
    Название игры:  B.L.U.E.: Legend of Water
    Название игры:  GRID
    Название игры:  NHL Hitz Pro
    Название игры:  Luxor: Pharaoh's Challenge
    Название игры:  Sega Rally 2006
    Название игры:  Half-Minute Hero 2
    Название игры:  Housekeeping
    Название игры:  Major League Baseball 2K8
    Название игры:  Sabre Wulf
    Название игры:  Swords
    Название игры:  Beyond the Labyrinth
    Название игры:  Bikkuriman Daijiten
    Название игры:  Majesty 2: The Fantasy Kingdom Sim
    Название игры:  Fullmetal Alchemist: Brotherhood
    Название игры:  Combat Elite: WWII Paratroopers
    Название игры:  Samurai Spirits: Tenkaichi Kenkakuden
    Название игры:  World of Tanks
    Название игры:  Battle vs. Chess
    Название игры:  Tom and Jerry in War of the Whiskers
    Название игры:  Super Duper Sumos
    Название игры:  The King of Fighters: Maximum Impact - Maniax
    Название игры:  Combat Wings: The Great Battles of WWII
    Название игры:  Tube Slider
    Название игры:  Umineko no Naku Koro ni San: Shinjitsu to Gensou no Yasoukyoku
    Название игры:  Payout Poker & Casino
    Название игры:  Wii de Asobu: Metroid Prime
    Название игры:  Legacy of Ys: Books I & II
    Название игры:  Saint
    Название игры:  Steal Princess
    Название игры:  Mario Tennis
    Название игры:  Runaway: A Twist of Fate
    Название игры:  Yu-Gi-Oh! 5D's Wheelie Breakers (JP sales)
    Название игры:  Cabela's Alaskan Adventure
    Название игры:  Writing and Speaking Beautiful Japanese DS
    Название игры:  Virtua Quest
    Название игры:  Shonen Jump's Yu-Gi-Oh! GX Card Almanac
    Название игры:  Without Warning
    Название игры:  PDC World Championship Darts 2008
    Название игры:  Dinotopia: The Sunstone Odyssey
    Название игры:  Jet Impulse
    Название игры:  Dream Dancer
    Название игры:  Dance! It's Your Stage
    Название игры:  Football Manager 2007
    Название игры:  Ferrari: The Race Experience
    Название игры:  Aquaman: Battle for Atlantis
    Название игры:  WRC: FIA World Rally Championship
    Название игры:  Homeworld Remastered Collection
    Название игры:  Shorts
    Название игры:  AKB1/48: Idol to Guam de Koishitara...
    Название игры:  Brothers in Arms: Furious 4
    Название игры:  Agarest Senki: Re-appearance
    Название игры:  PDC World Championship Darts 2008
    Название игры:  Freaky Flyers
    Название игры:  Inversion
    Название игры:  Hakuouki: Shinsengumi Kitan
    Название игры:  Virtua Quest
    


```python
data_with_titles_without_release_date[data_with_titles_without_release_date['name'] == 'LEGO Batman: The Videogame']
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>456</th>
      <td>LEGO Batman: The Videogame</td>
      <td>Wii</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1538</th>
      <td>LEGO Batman: The Videogame</td>
      <td>PSP</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
# проверим, все ли правильно спарсилось:
# самый ранний год игры по жанрам; если он меньше, чем дата выхода игры - значит что-то пошло не так при парсинге
data_with_titles_without_release_date.groupby('platform')['year_of_release'].min() # самые ранние даты релиза по платформам, которые спарсились
                                                                                
```




    platform
    2600   NaN
    3DS    NaN
    DS     NaN
    GB     NaN
    GBA    NaN
    GC     NaN
    N64    NaN
    PC     NaN
    PS     NaN
    PS2    NaN
    PS3    NaN
    PSP    NaN
    PSV    NaN
    Wii    NaN
    X360   NaN
    XB     NaN
    Name: year_of_release, dtype: float64



Даты релиза консолей:   
`3DS` - 2011;  
`DS` - 2004;  
`GBA` - 2001;  
`PS2` - 2000.

**Заменим вручную явные несостыковки**


```python
data_with_titles_without_release_date[(data_with_titles_without_release_date['platform'] == 'DS') \
                                     & (data_with_titles_without_release_date['year_of_release'] < 2004)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>




```python
data_with_titles_without_release_date.loc[12003, 'year_of_release'] = 2008
```


```python
data_with_titles_without_release_date[(data_with_titles_without_release_date['platform'] == '3DS') \
                                     & (data_with_titles_without_release_date['year_of_release'] < 2011)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>




```python
data_with_titles_without_release_date.loc[15338, 'year_of_release'] = 2014
```


```python
data_with_titles_without_release_date[(data_with_titles_without_release_date['platform'] == 'GBA') \
                                     & (data_with_titles_without_release_date['year_of_release'] < 2001)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>




```python
data_with_titles_without_release_date.loc[14210, 'year_of_release'] = 2004
```


```python
data_with_titles_without_release_date[(data_with_titles_without_release_date['platform'] == 'PS2') \
                                     & (data_with_titles_without_release_date['year_of_release'] < 2000)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>




```python
data_with_titles_without_release_date.loc[2157, 'year_of_release'] = 2003
data_with_titles_without_release_date.loc[8364, 'year_of_release'] = 2002
```


```python
# проверим одну из строк
data_with_titles_without_release_date.loc[2157]
```




    name               Wheel of Fortune
    platform                        PS2
    year_of_release              2003.0
    Name: 2157, dtype: object




```python
data_with_titles_without_release_date[data_with_titles_without_release_date['year_of_release'].isna()]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>183</th>
      <td>Madden NFL 2004</td>
      <td>PS2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>377</th>
      <td>FIFA Soccer 2004</td>
      <td>PS2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>456</th>
      <td>LEGO Batman: The Videogame</td>
      <td>Wii</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>475</th>
      <td>wwe Smackdown vs. Raw 2006</td>
      <td>PS2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>609</th>
      <td>Space Invaders</td>
      <td>2600</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>16373</th>
      <td>PDC World Championship Darts 2008</td>
      <td>PSP</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16405</th>
      <td>Freaky Flyers</td>
      <td>GC</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16448</th>
      <td>Inversion</td>
      <td>PC</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16458</th>
      <td>Hakuouki: Shinsengumi Kitan</td>
      <td>PS3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16522</th>
      <td>Virtua Quest</td>
      <td>GC</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>264 rows × 3 columns</p>
</div>



Минус 200 пропусков. В принципе из этих 69 тоже, думаю, добрая половина убирается: не парсятся тайтлы, где в начале названия есть `The` (на сайте без артикля), скорее всего я не вычистил все не буквенные символы. Но оставим как есть. Надо только прописать это в основном датафрейме.


```python
df.update(data_with_titles_without_release_date)
print('Осталось пропусков в столбце "year_of_release" после парсинга: ' + str(df[df['year_of_release'].isna()]['name'].count()))
```

    Осталось пропусков в столбце "year_of_release" после парсинга: 264
    

#### Столбец `rating`


```python
# создадим датафрейм с играми, у которых не указан рейтинг:
data_with_titles_without_rating = df.loc[df['rating'].isna()][['name', 'platform', 'rating']]
data_with_titles_without_rating.head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Super Mario Bros.</td>
      <td>NES</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Pokemon Red/Pokemon Blue</td>
      <td>GB</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tetris</td>
      <td>GB</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Duck Hunt</td>
      <td>NES</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Nintendogs</td>
      <td>DS</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Pokemon Gold/Pokemon Silver</td>
      <td>GB</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Super Mario World</td>
      <td>SNES</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Pokemon Diamond/Pokemon Pearl</td>
      <td>DS</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Super Mario Land</td>
      <td>GB</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Super Mario Bros. 3</td>
      <td>NES</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
print(get_rating(data_with_titles_without_rating.loc[10]))
print(get_rating(data_with_titles_without_rating.loc[18]))
```

    Nintendogs
    None
    Super Mario World
    None
    

Работать - работает, но парсит очень долго и у большинства игр действительно нет рейтинга даже на сайте. Видимо, рейтинг ввели позже их релиза. Заменим пропуски фразой `no rating`, а рейтинг `K-A` на `E`. 


```python
# заменим пропуски 
df['rating'] = df['rating'].fillna('no rating')
```


```python
# заменим рейтинг K-A на E
df['rating'] = df['rating'].where(~(df['rating'] == 'K-A'), 'E')
```

### Поиск и устранение выбросов и аномалий 


```python
df['year_of_release'] = df['year_of_release'].astype("Int64") # После парсинга из-за NaN опять меняется тип столбца на float64
                                                            # вернем int64
```


```python
df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year_of_release</th>
      <th>na_sales</th>
      <th>eu_sales</th>
      <th>jp_sales</th>
      <th>other_sales</th>
      <th>critic_score</th>
      <th>user_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>16449.000000</td>
      <td>16713.000000</td>
      <td>16713.000000</td>
      <td>16713.000000</td>
      <td>16713.000000</td>
      <td>8137.000000</td>
      <td>7590.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2006.486169</td>
      <td>0.263302</td>
      <td>0.145045</td>
      <td>0.077625</td>
      <td>0.047343</td>
      <td>68.967679</td>
      <td>7.125046</td>
    </tr>
    <tr>
      <th>std</th>
      <td>5.875135</td>
      <td>0.813565</td>
      <td>0.503359</td>
      <td>0.308871</td>
      <td>0.186742</td>
      <td>13.938165</td>
      <td>1.500006</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1980.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>13.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2003.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>60.000000</td>
      <td>6.400000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2007.000000</td>
      <td>0.080000</td>
      <td>0.020000</td>
      <td>0.000000</td>
      <td>0.010000</td>
      <td>71.000000</td>
      <td>7.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2010.000000</td>
      <td>0.240000</td>
      <td>0.110000</td>
      <td>0.040000</td>
      <td>0.030000</td>
      <td>79.000000</td>
      <td>8.200000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2016.000000</td>
      <td>41.360000</td>
      <td>28.960000</td>
      <td>10.220000</td>
      <td>10.570000</td>
      <td>98.000000</td>
      <td>9.700000</td>
    </tr>
  </tbody>
</table>
</div>



- `year_of_release`: в одной из игр скорее всего неправильно спарсилась дата релиза (видимо, это приставка atari 2600). Поправим.
- `na_sales`, `eu_sales`, `jp_sales`, `other_sales`: есть игры, у которых в графах продаж по регионам указаны нули. Посмотрим, есть ли строки, где во всех трех регионах нет продаж. Если такие игры найдутся, и дата релиза будет не 2016 год (учитывая, что по условию база данных на 2016 год, игры с датой релиза в 2016 году могут еще не обладать статистикой продаж на момент формирования датафрейма, в то время как по играм, вышедшим ранее уже точно должна быть такая информация), то удалим эти строки. Они малоинформативны для нас. 

#### Поиск аномалий в столбце `year_of_release`


```python
df[df['year_of_release'] == 2600]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
      <th>genre</th>
      <th>na_sales</th>
      <th>eu_sales</th>
      <th>jp_sales</th>
      <th>other_sales</th>
      <th>critic_score</th>
      <th>user_score</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>



Это действительно игра на платформе Atari 2600. Почему-то парсит платформу, а не год релиза. Поменяем руками на `1982`.


```python
df.loc[4132, 'year_of_release'] = 1982

# проверим
df.loc[4132]
```




    name                  Karate
    platform                2600
    year_of_release         1982
    genre               Fighting
    na_sales                0.44
    eu_sales                0.03
    jp_sales                 0.0
    other_sales              0.0
    critic_score             NaN
    user_score               NaN
    rating             no rating
    Name: 4132, dtype: object



#### Поиск аномалий по столбцам `na_sales`, `eu_sales`, `jp_sales`, `other_sales`


```python
df[(df['na_sales'] == 0) & \
  (df['eu_sales'] == 0) & \
  (df['jp_sales'] == 0) &
  (df['other_sales'] == 0)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
      <th>genre</th>
      <th>na_sales</th>
      <th>eu_sales</th>
      <th>jp_sales</th>
      <th>other_sales</th>
      <th>critic_score</th>
      <th>user_score</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16676</th>
      <td>G1 Jockey 4 2008</td>
      <td>PS3</td>
      <td>2008</td>
      <td>Sports</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
    </tr>
    <tr>
      <th>16709</th>
      <td>SCORE International Baja 1000: The Official Game</td>
      <td>PS2</td>
      <td>2008</td>
      <td>Racing</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
    </tr>
  </tbody>
</table>
</div>



Две игры, которые не несут никакой ценности для нас: нет ни продаж, ни оценок, ни рейтинга. Сгодятся только для подсчета количества игр, вышедших в тот или иной год на определенной платформе. Но, думаю, без 2 строк мы переживем. 


```python
df.drop(labels=[16676, 16709], axis=0, inplace=True)
```


```python
df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year_of_release</th>
      <th>na_sales</th>
      <th>eu_sales</th>
      <th>jp_sales</th>
      <th>other_sales</th>
      <th>critic_score</th>
      <th>user_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>16448.000000</td>
      <td>16711.000000</td>
      <td>16711.000000</td>
      <td>16711.000000</td>
      <td>16711.000000</td>
      <td>8137.000000</td>
      <td>7590.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2006.484497</td>
      <td>0.263334</td>
      <td>0.145063</td>
      <td>0.077634</td>
      <td>0.047348</td>
      <td>68.967679</td>
      <td>7.125046</td>
    </tr>
    <tr>
      <th>std</th>
      <td>5.878391</td>
      <td>0.813609</td>
      <td>0.503386</td>
      <td>0.308888</td>
      <td>0.186752</td>
      <td>13.938165</td>
      <td>1.500006</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1980.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>13.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2003.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>60.000000</td>
      <td>6.400000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2007.000000</td>
      <td>0.080000</td>
      <td>0.020000</td>
      <td>0.000000</td>
      <td>0.010000</td>
      <td>71.000000</td>
      <td>7.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2010.000000</td>
      <td>0.240000</td>
      <td>0.110000</td>
      <td>0.040000</td>
      <td>0.030000</td>
      <td>79.000000</td>
      <td>8.200000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2016.000000</td>
      <td>41.360000</td>
      <td>28.960000</td>
      <td>10.220000</td>
      <td>10.570000</td>
      <td>98.000000</td>
      <td>9.700000</td>
    </tr>
  </tbody>
</table>
</div>



Выглядит правдоподобно. В датафрейме собраны игры с 1977 года по 2016 год. Несмотря на то, что есть нули в отдельных регионах, минимальное значение по столбцу `total_sales` больше нуля (в этом можно убедиться чуть ниже 👇). Оценка критиков в диапазоне от 0 до 100, игроков - от 0 до 10.   

## Исследовательский анализ данных

### Расчет суммарных продаж во всех регионах


```python
df['total_sales'] = df['na_sales'] + df['eu_sales'] + df['jp_sales'] + df['other_sales']
df.head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
      <th>genre</th>
      <th>na_sales</th>
      <th>eu_sales</th>
      <th>jp_sales</th>
      <th>other_sales</th>
      <th>critic_score</th>
      <th>user_score</th>
      <th>rating</th>
      <th>total_sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wii Sports</td>
      <td>Wii</td>
      <td>2006</td>
      <td>Sports</td>
      <td>41.36</td>
      <td>28.96</td>
      <td>3.77</td>
      <td>8.45</td>
      <td>76.0</td>
      <td>8.0</td>
      <td>E</td>
      <td>82.54</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Super Mario Bros.</td>
      <td>NES</td>
      <td>1985</td>
      <td>Platform</td>
      <td>29.08</td>
      <td>3.58</td>
      <td>6.81</td>
      <td>0.77</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>40.24</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mario Kart Wii</td>
      <td>Wii</td>
      <td>2008</td>
      <td>Racing</td>
      <td>15.68</td>
      <td>12.76</td>
      <td>3.79</td>
      <td>3.29</td>
      <td>82.0</td>
      <td>8.3</td>
      <td>E</td>
      <td>35.52</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Wii Sports Resort</td>
      <td>Wii</td>
      <td>2009</td>
      <td>Sports</td>
      <td>15.61</td>
      <td>10.93</td>
      <td>3.28</td>
      <td>2.95</td>
      <td>80.0</td>
      <td>8.0</td>
      <td>E</td>
      <td>32.77</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Pokemon Red/Pokemon Blue</td>
      <td>GB</td>
      <td>1996</td>
      <td>Role-Playing</td>
      <td>11.27</td>
      <td>8.89</td>
      <td>10.22</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>31.38</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tetris</td>
      <td>GB</td>
      <td>1989</td>
      <td>Puzzle</td>
      <td>23.20</td>
      <td>2.26</td>
      <td>4.22</td>
      <td>0.58</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>30.26</td>
    </tr>
    <tr>
      <th>6</th>
      <td>New Super Mario Bros.</td>
      <td>DS</td>
      <td>2006</td>
      <td>Platform</td>
      <td>11.28</td>
      <td>9.14</td>
      <td>6.50</td>
      <td>2.88</td>
      <td>89.0</td>
      <td>8.5</td>
      <td>E</td>
      <td>29.80</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Wii Play</td>
      <td>Wii</td>
      <td>2006</td>
      <td>Misc</td>
      <td>13.96</td>
      <td>9.18</td>
      <td>2.93</td>
      <td>2.84</td>
      <td>58.0</td>
      <td>6.6</td>
      <td>E</td>
      <td>28.91</td>
    </tr>
    <tr>
      <th>8</th>
      <td>New Super Mario Bros. Wii</td>
      <td>Wii</td>
      <td>2009</td>
      <td>Platform</td>
      <td>14.44</td>
      <td>6.94</td>
      <td>4.70</td>
      <td>2.24</td>
      <td>87.0</td>
      <td>8.4</td>
      <td>E</td>
      <td>28.32</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Duck Hunt</td>
      <td>NES</td>
      <td>1984</td>
      <td>Shooter</td>
      <td>26.93</td>
      <td>0.63</td>
      <td>0.28</td>
      <td>0.47</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>28.31</td>
    </tr>
  </tbody>
</table>
</div>



### Сколько игр выпускалось в разные годы

Для ответа на этот вопрос построим столбчатую диаграмму с количеством релизов по годам. 


```python
print_bar('year_of_release', 'count')
```


    
![png](output_93_0.png)
    



```python
df['platform'].unique()
```




    array(['Wii', 'NES', 'GB', 'DS', 'X360', 'PS3', 'PS2', 'SNES', 'GBA',
           'PS4', '3DS', 'N64', 'PS', 'XB', 'PC', '2600', 'PSP', 'XOne',
           'WiiU', 'GC', 'GEN', 'DC', 'PSV', 'SAT', 'SCD', 'WS', 'NG', 'TG16',
           '3DO', 'GG', 'PCFX'], dtype=object)



Как мы видим на графике, рассвет игровой индустрии пришелся на начало 90-х годов прошлого столетия и своего пика достиг в 2008 - 2009 годах. Возможно, такой резкий скачок связан с [появлением Pentium 1](https://habr.com/ru/company/timeweb/blog/656315/) и выходом привычных нам персональных компьютеров в массы. Однако, уже к 2012 году объем игрового рынка схлопнулся в 2 раза по сравнению с пиковым 2008 (1400+ тайтлов в 2008 против ~700 в 2012). С чем связано "охлаждение" игрового рынка с начала 2010 года  сложно сказать. Учитывая, что в нашей базе данных нет мобильной платформы, возможно, с появлением первых смартфонов они стали потихоньку "отгрызать" рынок у остальных платформ. 

Учитывая, что мы собираемся делать прогноз на 2017 год, нам не нужны данные по старым платформам и играм. Практически у всех современных и актуальных консолей (платформ) существует такое понятие, как "поколение" (Nintendo консоли - аномалия от мира консолей =)). На 2016-2017 годы актуальными можно считать такие платформы, как:
- `Xbox 360`; 
- `PlayStation 3`;
- `PlayStation 2` (с натяжкой);
- `PlayStation 4`;
- `PC` (ПК-бояре всегда на коне);
- `Nintendo 3DS` (удивительно, но поддержка прекращена только в [2020](https://ru.wikipedia.org/wiki/Nintendo_3DS#:~:text=15%20%D1%84%D0%B5%D0%B2%D1%80%D0%B0%D0%BB%D1%8F%202022%20%D0%B3%D0%BE%D0%B4%D0%B0%20Nintendo,eShop%20%D0%B4%D0%BB%D1%8F%20%D1%81%D0%B5%D0%BC%D0%B5%D0%B9%D1%81%D1%82%D0%B2%D0%B0%20%D0%BA%D0%BE%D0%BD%D1%81%D0%BE%D0%BB%D0%B5%D0%B9%203DS.));
- `Xbox One`;
- `WiiU`;
- `PSV`.

Прекращена поддержка: 
- `Wii` - [20 октября 2013](https://ru.wikipedia.org/wiki/Wii);
- `NES` - [25 сентября 2003](https://ru.wikipedia.org/wiki/Nintendo_Entertainment_System#:~:text=%D0%9F%D0%BE%D1%81%D0%BB%D0%B5%201995%20%D0%B3%D0%BE%D0%B4%D0%B0%2C%20%D0%BD%D0%B0%20%D1%84%D0%BE%D0%BD%D0%B5,%D1%82%D0%B8%D1%80%D0%B0%D0%B6%D0%B0%D0%BC%D0%B8%20%D0%B4%D0%BE%20%D0%BE%D0%BA%D1%82%D1%8F%D0%B1%D1%80%D1%8F%202003%20%D0%B3%D0%BE%D0%B4%D0%B0);
- `GameBoy` - [23 марта 2003](https://ru.wikipedia.org/wiki/Game_Boy);
- `Nintendo DS` - [31 августа 2013](https://ru.wikipedia.org/wiki/Nintendo_DS);
- `SNES` - [23 мая 2005](https://ru.wikipedia.org/wiki/Super_Nintendo_Entertainment_System);
- `GameBoy Advance` - [2008](https://ru.wikipedia.org/wiki/Game_Boy_Advance);
- `Nintendo 64` - [30 апреля 2002](https://ru.wikipedia.org/wiki/Nintendo_64);
- `PlayStation` - [23 марта 2006](https://ru.wikipedia.org/wiki/PlayStation);
- `Xbox` - [2 марта 2009](https://ru.wikipedia.org/wiki/Xbox);
- `Atari 2600` - [1984](https://ru.wikipedia.org/wiki/Atari_2600);
- `PSP` - [декабрь 2014](https://ru.wikipedia.org/wiki/PlayStation_Portable);
- `GameCube` - [2007](https://ru.wikipedia.org/wiki/Nintendo_GameCube);
- `Genesis` - [1999](https://ru.wikipedia.org/wiki/Sega_Mega_Drive);
- `DreamCast` - [31 марта 2001](https://ru.wikipedia.org/wiki/Dreamcast);
- `SAT (Sega Saturn)` - [4 декабря 2000](https://ru.wikipedia.org/wiki/Sega_Saturn);
- `SCD (Sega CD)` - [1996](https://ru.wikipedia.org/wiki/Sega_Mega-CD);
- `WS (WonderSwan)` - [9 декабря 2000](https://ru.wikipedia.org/wiki/WonderSwan_Color);
- `NG (Neo-Geo)` - [август 2007](https://ru.wikipedia.org/wiki/Neo-Geo);
- `TG (TurboGrafx-16)` - [1994](https://ru.wikipedia.org/wiki/PC_Engine);
- `3DO (3DO Interactive Multiplayer)` - [1996](https://ru.wikipedia.org/wiki/3DO_Interactive_Multiplayer);
- `GG (Sega Game Gear)` - [декабрь 1996](https://ru.wikipedia.org/wiki/Sega_Game_Gear);
- `PC-FX` - [февраль 1998](https://wiki5.ru/wiki/PC-FX).

### Изменение продаж игр по платформам


```python
print_bar('platform', 'sum', 'total_sales')
```


    
![png](output_98_0.png)
    


Консоль PS2 появилась на прилавках магазинов 4 марта 2000 года, как раз в то самое время, когда игровая индустрия начала набирать свои обороты. Консоль практически положила начало массовым и общедоступным играм, став, наверное, самой народной консолью. Безусловно, за это время было разработано и продано больше всего игр.  
Консоли Xbox360 и PS3 появились в конце 2005 и 2006 годов, соответственно. В это время в индустрию начали поступать крупные суммы денег, люди поняли, что на игровой индустрии можно еще и зарабатывать, появились, так называемые AAA-игры, с режисурой, постановкой, масштабом, игры уже точно перестали быть гиковской темой. Не удивительно, что у этих платформ тоже одни из лучших продаж.  
Где-то особняком от всего этого стоит Nintendo со своими экспериментальными (порой даже чересчур) консолями и под стать им играми. Но азиатский рынок огромный, а Nintendo всегда была там сверх популярна. Отсюда и такие продажи на Wii, Nintendo DS.  
Интересна ситуация с PS4 (15.11.2013) и Xbox One (22.11.2013). Да, в первые годы выхода новых консолей разработчики только присматриваются и тестят новые мощности, как правило, игры выходят и не предыдущие поколения, поэтому продажи пока что (на конец 2016) довольно скромные. Но уже сейчас наглядно можно увидеть, как Microsoft проиграла конкуренцию Sony в этом поколении консолей. Причин много: и смена руководства игрового подразделения, и попытка переосмыслить консоль и сделать ее чуть ли не заменирелем ресивера цифрового телефидения, и требования по постоянному нахождению в онлайне (даже для single игр), вследствие чего невозможность перепродавать и делиться играми, отсутствие обратной совместимости и многое другое (подробнее можно почитать [тут](https://www.igromania.ru/article/31445/PS4_protiv_Xbox_One._Kak_Sony_pereigrala_Microsoft.html)).  
Также можно наблюдать провал консоли WiiU, относительно неплохие продажи для консолей PSP и PSV (как для портативных и нишевых вещей).  
Удивительны такие маленькие продажи на PC.

Проанализируем, как менялись продажи по платформам. Выберем ТОП-6 платформ (они лидируют с большим отрывом) с наибольшими суммарными продажами и построим распределение по годам, а также захватим персональные компьютеры, так как это отдельный весьма значимый пласт игр. 


```python
# выделим ТОП-10 платформ по продажам
top_7 = df.groupby(['platform'])['total_sales'].sum().sort_values(ascending=False).index.tolist()[:6]
top_7.append('PC')
top_7
```




    ['PS2', 'X360', 'PS3', 'Wii', 'DS', 'PS', 'PC']




```python
print_line_graph(top_7)
```


    
![png](output_102_0.png)
    


Как мы можем видеть по графику, средний срок жизни консоли около 10 лет:  
`PS` - с 1994 по 2003 гг (9 лет);  
`PS2` - с 2000 по 2011 гг (11 лет);  
`PS3` - с 2003 по 2016 гг (дальше просто нет данных, а так PS3 еще в определенных регионах поддерживалась до 2017 года, вроде бы);  
`X360` - с 2005 по 2016 гг (11 лет);  
`Wii` - с 2006 по 2016 гг (10 лет);  
`DS` - вышла с 1985 году, но стремительную популярность обрела в 2004 (а может быть, что-то слодалось при выгрузке данных, и у нас не совсем достоверная информация по DS), просуществовала до 2013 года;  
`PC` - вечен😎  
В общем и целом это закономерно. 10 лет - итак длительный срок для торможения развития игровой индустрии для ПК-бояр =)  

На графике также хорошо видно, как происходит смена поколений консолей. Популярность предыдущей версии потихоньку начинает падать примерно в год анонса (появления первых слухов) начала создания следующей версии.  

Как я уже отмечал выше, для построения прогноза на 2017 год нам не нужно исследовать не актуальные платформы. Наиболее репрезентабельная выборка получится по консолям, которые либо недавно вышли и в ближайшие годы только будут набирать геймерскую базу и популярность, либо консоли "в самом расвете сил", которые еще останутся актуальными в ближайшие пару лет. Думаю, оптимально актуальным периодом считать с 2014 по 2016 годы. Однако, как сказано в исходных данных проекта, информация за 2016 год может быть не полной. Учитывая этот факт, где это будет важно, будем исключать 2016 год из "актуального периода", поскольку в датафрейме может быть статистика как по всему 2016 году, так и только по первому его месяцу, что может в дальнейшем исказить выводы.   

### Платформы - лидеры по продажам

Для того, чтобы выбрать потенциально прибыльные платформы, найдем ТОП-5 по продажам за выбранный актуальный период 2014-2015 гг. 


```python
print_bar('platform', 'sum', 'total_sales', query='year_of_release >= 2014 and year_of_release < 2016')
```


    
![png](output_106_0.png)
    



```python
top_5_by_total_sales_2014_2015 = ['PS4', 'XOne', '3DS', 'PS3', 'X360']
```

Также, чтобы понять, какую платформу можно считать потенциально прибыльной посмотрим на ее жизненный цикл, может случиться так, что продаж на платформе много, но пик давно пройден и консоль на закате своего жизненного цикла. 


```python
print_line_graph(top_5_by_total_sales_2014_2015, 'year_of_release >= 2006 and year_of_release < 2016')
```


    
![png](output_109_0.png)
    


Как мы можем видеть, в последние два года (2014-2015) лидируют по продажам консоли `PS4`, `XOne` и `3DS`. Причем консоль от Sony практически в 2 раза превосходит по продажам копий игр своих главных конкурентов - Microsoft.  
Если выделять потенциально прибыльные консоли в 2017 году, то это, безусловно `PS4`, `XOne`. С `3DS` ситуация непонятная. Исходя из имеющихся данных, на консоль с самого её выхода каждый год продавали все меньше и меньше копий игр, поэтому делать ставку и на нее рискованно. Да, продажи не так значительно проседают по сравнению с ее большими собратами, но и консоль сама по себе довольно нишевая. На `PS3` и `X360` точно не стоит делать ставку. Это консоли в конце своего жизненного цикла, причем их новые модели на рынке уже по 3 года, и вполне вероятно, что разработчики уже отказались от поддержки старых консолей, что автоматически убивает весь коммерческий интерес к ним.   


```python
# актуальный период с 2016 годом; все платформы (которые дожили)
print_line_graph(query='year_of_release >= 2014 and year_of_release <= 2016')
```


    
![png](output_111_0.png)
    


<font color=blue>По таким данным можно сделать вывод, что в 2015 году был какой-то переломный момент, и продажи по всем платформам пошли на спад, а игровая индустрия загибается, но это же не совсем так.</font>


```python
# актуальный период без 2016 года; все платформы (которые дожили)
print_line_graph(query='year_of_release >= 2014 and year_of_release < 2016')
```


    
![png](output_113_0.png)
    


<font color=blue>Без 2016 года уже более понятные данные. Растут продажи `PS4` и `XOne`. Все остальные платформы либо стагнируют, либо находятся в упадке. Но за 2 года динамика может быть обманчива.</font>


```python
# актуальный период без 2016 года; все платформы (которые дожили), но без PS4 и XOne, чтобы посмотреть поближе на остальных
print_line_graph(['3DS', 'WiiU', 'PS3', 'X360', 'PC', 'Wii', 'PSV', 'PSP'], query='year_of_release >= 2014 and year_of_release < 2016')
```


    
![png](output_115_0.png)
    


<font color=blue>Предположение подтвердилось: либо стагнируют, либо падают.</font>


```python
# последние 10 лет, с 2016 годом; все платформы
print_line_graph(query='year_of_release >= 2006 and year_of_release <= 2016')
```


    
![png](output_117_0.png)
    


<font color=blue> 2016 год портит картину: из-за него все платформы будто бы прошли свои пики.</font>


```python
# последние 10 лет, без 2016 годом; все платформы
print_line_graph(query='year_of_release >= 2006 and year_of_release < 2016')
```


    
![png](output_119_0.png)
    


<font color=blue>Сложно, но все-таки можно разглядеть, что `PS4` и `XOne` явно набирают обороты, `PC` - своего рода плато, так же как `WiiU` и `PSV`. Остальные платформы стремительно падают.
По актуальному периоду тоже можно это понять, но тогда все-таки остается вероятность, что это временная просадка или взлет (слишком мало лет).</font>


```python
print_line_graph(query='year_of_release >= 2012 and year_of_release < 2016')
```


    
![png](output_121_0.png)
    


### График "ящик с усами" по глобальным продажам игр в разбивке по платформам

Поскольку отныне все манипуляции будут происходить с данными за актуальный период, создадим новый датафрейм.


```python
df_actual_2014_2016 = df.query('year_of_release >= 2014')
```


```python
df_actual_2014_2016.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
      <th>genre</th>
      <th>na_sales</th>
      <th>eu_sales</th>
      <th>jp_sales</th>
      <th>other_sales</th>
      <th>critic_score</th>
      <th>user_score</th>
      <th>rating</th>
      <th>total_sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31</th>
      <td>Call of Duty: Black Ops 3</td>
      <td>PS4</td>
      <td>2015</td>
      <td>Shooter</td>
      <td>6.03</td>
      <td>5.86</td>
      <td>0.36</td>
      <td>2.38</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>14.63</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Grand Theft Auto V</td>
      <td>PS4</td>
      <td>2014</td>
      <td>Action</td>
      <td>3.96</td>
      <td>6.31</td>
      <td>0.38</td>
      <td>1.97</td>
      <td>97.0</td>
      <td>8.3</td>
      <td>M</td>
      <td>12.62</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Pokemon Omega Ruby/Pokemon Alpha Sapphire</td>
      <td>3DS</td>
      <td>2014</td>
      <td>Role-Playing</td>
      <td>4.35</td>
      <td>3.49</td>
      <td>3.10</td>
      <td>0.74</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>11.68</td>
    </tr>
    <tr>
      <th>77</th>
      <td>FIFA 16</td>
      <td>PS4</td>
      <td>2015</td>
      <td>Sports</td>
      <td>1.12</td>
      <td>6.12</td>
      <td>0.06</td>
      <td>1.28</td>
      <td>82.0</td>
      <td>4.3</td>
      <td>E</td>
      <td>8.58</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Star Wars Battlefront (2015)</td>
      <td>PS4</td>
      <td>2015</td>
      <td>Shooter</td>
      <td>2.99</td>
      <td>3.49</td>
      <td>0.22</td>
      <td>1.28</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>7.98</td>
    </tr>
  </tbody>
</table>
</div>




```python
plt.figure(figsize=(15, 10))
sns.boxplot(data=df_actual_2014_2016, x='platform', y='total_sales')
plt.ylim([0, 2])
plt.title('Диаграмма размаха')
plt.xlabel('Платформы')
plt.ylabel('Общие продажи, млн. копий')
plt.show()
```


    
![png](output_126_0.png)
    



```python
# для того, чтобы посмотреть на аномалии 
plt.figure(figsize=(15, 10))
sns.boxplot(data=df_actual_2014_2016, x='platform', y='total_sales')

plt.title('Диаграмма размаха')
plt.xlabel('Платформы')
plt.ylabel('Общие продажи, млн. копий')
plt.show()
```


    
![png](output_127_0.png)
    



```python
df_actual_2014_2016.groupby('platform')['total_sales'].describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>platform</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3DS</th>
      <td>213.0</td>
      <td>0.407042</td>
      <td>1.185861</td>
      <td>0.01</td>
      <td>0.0300</td>
      <td>0.090</td>
      <td>0.2500</td>
      <td>11.68</td>
    </tr>
    <tr>
      <th>PC</th>
      <td>151.0</td>
      <td>0.179139</td>
      <td>0.329359</td>
      <td>0.01</td>
      <td>0.0200</td>
      <td>0.060</td>
      <td>0.2000</td>
      <td>3.05</td>
    </tr>
    <tr>
      <th>PS3</th>
      <td>219.0</td>
      <td>0.311324</td>
      <td>0.633059</td>
      <td>0.01</td>
      <td>0.0400</td>
      <td>0.110</td>
      <td>0.3250</td>
      <td>5.27</td>
    </tr>
    <tr>
      <th>PS4</th>
      <td>376.0</td>
      <td>0.766356</td>
      <td>1.614969</td>
      <td>0.01</td>
      <td>0.0575</td>
      <td>0.185</td>
      <td>0.6900</td>
      <td>14.63</td>
    </tr>
    <tr>
      <th>PSP</th>
      <td>13.0</td>
      <td>0.027692</td>
      <td>0.027735</td>
      <td>0.01</td>
      <td>0.0100</td>
      <td>0.020</td>
      <td>0.0200</td>
      <td>0.09</td>
    </tr>
    <tr>
      <th>PSV</th>
      <td>295.0</td>
      <td>0.075932</td>
      <td>0.141591</td>
      <td>0.01</td>
      <td>0.0200</td>
      <td>0.040</td>
      <td>0.0900</td>
      <td>1.96</td>
    </tr>
    <tr>
      <th>Wii</th>
      <td>11.0</td>
      <td>0.460909</td>
      <td>0.625451</td>
      <td>0.01</td>
      <td>0.0350</td>
      <td>0.180</td>
      <td>0.7550</td>
      <td>2.01</td>
    </tr>
    <tr>
      <th>WiiU</th>
      <td>73.0</td>
      <td>0.588767</td>
      <td>1.161467</td>
      <td>0.01</td>
      <td>0.0500</td>
      <td>0.190</td>
      <td>0.5700</td>
      <td>7.09</td>
    </tr>
    <tr>
      <th>X360</th>
      <td>111.0</td>
      <td>0.434414</td>
      <td>0.628967</td>
      <td>0.01</td>
      <td>0.0700</td>
      <td>0.180</td>
      <td>0.5050</td>
      <td>4.28</td>
    </tr>
    <tr>
      <th>XOne</th>
      <td>228.0</td>
      <td>0.615614</td>
      <td>1.046513</td>
      <td>0.01</td>
      <td>0.0500</td>
      <td>0.205</td>
      <td>0.6325</td>
      <td>7.39</td>
    </tr>
  </tbody>
</table>
</div>



По медианным значениям общих продаж игр на платформе можно сделать предположение, чего ожидать от 2017 года. Так, у записанных нами в потенциально прибыльные консоли - `PS4` и `XOne` - медианные продажи игр примерно на одном уровне: 0,185 и 0,205 соответственно. У `3DS` и всех остальных платформ этот показатель значительно меньше, что говорит о том, что выбор сделан правильный.

### Влияние отзывов пользователей и критиков на продажи игры внутри самых популярных платформ


```python
fig, axes = plt.subplots(2, 2)
# subplot 1
axes[0, 0].scatter(df_actual_2014_2016.query('platform == "PS4"')['critic_score'], \
                df_actual_2014_2016.query('platform == "PS4"')['total_sales'], ec='black')
axes[0, 0].set_title('Диаграмма рассеяния по платформе PS4')
axes[0, 0].set_xlabel('Оценки критиков')
axes[0, 0].set_ylabel('Общие продажи, млн. копий')

#subplot 2
axes[0, 1].scatter(df_actual_2014_2016.query('platform == "PS4"')['user_score'], \
                df_actual_2014_2016.query('platform == "PS4"')['total_sales'], ec='black')
axes[0, 1].set_title('Диаграмма рассеяния по платформе PS4')
axes[0, 1].set_xlabel('Оценки игроков')
axes[0, 1].set_ylabel('Общие продажи, млн. копий')

#subplot 3
axes[1, 0].scatter(df_actual_2014_2016.query('platform == "XOne"')['critic_score'], \
                df_actual_2014_2016.query('platform == "XOne"')['total_sales'], ec='black', color='green')
axes[1, 0].set_title('Диаграмма рассеяния по платформе XOne')
axes[1, 0].set_xlabel('Оценки критиков')
axes[1, 0].set_ylabel('Общие продажи, млн. копий')

#subplot 4
axes[1, 1].scatter(df_actual_2014_2016.query('platform == "XOne"')['user_score'], \
                df_actual_2014_2016.query('platform == "XOne"')['total_sales'], ec='black', color='green')
axes[1, 1].set_title('Диаграмма рассеяния по платформе XOne')
axes[1, 1].set_xlabel('Оценки игроков')
axes[1, 1].set_ylabel('Общие продажи, млн. копий')

fig.set_figwidth(12)
fig.set_figheight(10)
```


    
![png](output_131_0.png)
    



```python
# по платформе PS4
print('Корреляция между отзывами критиков и продажами на платформе PS4: ' \
      + str(round(df_actual_2014_2016.query('platform == "PS4"')['critic_score'].corr(df_actual_2014_2016.query('platform == "PS4"')['total_sales']), 3)))
print('Корреляция между отзывами игроков и продажами на платформе PS4: ' \
      + str(round(df_actual_2014_2016.query('platform == "PS4"')['user_score'].corr(df_actual_2014_2016.query('platform == "PS4"')['total_sales']), 3)))

# по платформе XOne
print('Корреляция между отзывами критиков и продажами на платформе XOne: ' \
      + str(round(df_actual_2014_2016.query('platform == "XOne"')['critic_score'].corr(df_actual_2014_2016.query('platform == "XOne"')['total_sales']), 3)))
print('Корреляция между отзывами игроков и продажами на платформе XOne: ' \
      + str(round(df_actual_2014_2016.query('platform == "XOne"')['user_score'].corr(df_actual_2014_2016.query('platform == "XOne"')['total_sales']), 3)))
```

    Корреляция между отзывами критиков и продажами на платформе PS4: 0.403
    Корреляция между отзывами игроков и продажами на платформе PS4: -0.04
    Корреляция между отзывами критиков и продажами на платформе XOne: 0.429
    Корреляция между отзывами игроков и продажами на платформе XOne: -0.07
    

<font color=blue>Учитывая тот факт, что значения коэффициентов корреляции менее +0,5 или более -0,5 не считаются значимыми, можно сделать вывод, что взаимосвязи между какими-либо отзывами, будь то критики или игроки, и продажами копий игры нет.</font>

![корреляция](http://dl3.joxi.net/drive/2023/02/06/0055/3022/3648462/62/ae186afaf3.jpg)  

**Корреляция оценок критиков и игроков с продажами игр на ТОП-5 лучших платформах по продажам игр в последние годы**


```python
# платформы отсюда: top_5_by_total_sales_2014_2015
# ДФ отсюда: df_actual_2014_2016
rows = 2
columns = 3
fig, axes = plt.subplots(rows, columns, figsize=(20, 7))
count = 0
for i in range(rows):
    for j in range(columns):
        if count > len(top_5_by_total_sales_2014_2015) - 1:
            break
        else:
            platform = top_5_by_total_sales_2014_2015[count]
            df_for_heatmap = df_actual_2014_2016[df_actual_2014_2016['platform'] == platform][['total_sales', 'critic_score', 'user_score']]
            sns.set(font_scale=1.0)
            ax = sns.heatmap(df_for_heatmap.corr()[['total_sales']].sort_values(by='total_sales', ascending=False), annot=True, cmap='Greens', ax=axes[i, j])
            ax.set_title(platform, fontsize=20)
            ax.set_yticklabels(ax.get_yticklabels(), rotation=0, fontsize=15)
            plt.tight_layout(pad=3)
            ax.set_xticklabels('')
            ax.set_xlabel('total_sales', fontsize=15)
            count += 1

ax = sns.heatmap(df_actual_2014_2016[['total_sales', 'critic_score', 'user_score']].corr()[['total_sales']].sort_values(by='total_sales', ascending=False), 
                 annot=True, cmap='Greens', ax=axes[1, 2])
ax.set_title('По всему актуальному датафрейму', fontsize=15)
plt.show()
```


    
![png](output_135_0.png)
    


<font color=blue>Срез по наиболее популярным платформам последних лет, а также матрица корреляции в целом по всему актуальному датафрейму подтверждают предположение, что между оценками и продажами игр корреляции нет.</font>

### Распределение игр по жанрам


```python
# по всему ДФ
pivot_by_genre_all_df_v_2 = (df.groupby('genre')
                  .agg({'total_sales': 'median'})
                  .sort_values(by='total_sales', ascending=False))

# по ДФ последних лет
pivot_by_genre_actual_df_v_2 = (df_actual_2014_2016.groupby('genre')
                  .agg({'total_sales': 'median'})
                  .sort_values(by='total_sales', ascending=False))


# построим по этим ДФ столбчатые диаграммы
# ДФ по всему периоду
fig, axes = plt.subplots(2, 1, figsize=(20, 20))
ax = pivot_by_genre_all_df_v_2.plot(kind='bar', ax=axes[0], ec='black', grid=False)
ax.set_xlabel('Жанры игр')
ax.set_xticklabels(ax.get_xticklabels(), rotation=0)
ax.legend(['Медианные общие продажи, млн. копий'])
ax.set_title('За весь имеющийся период')
plt.tight_layout(pad=5)

# ДФ по актуальному периоду
ax = pivot_by_genre_actual_df_v_2.plot(kind='bar', ax=axes[1], ec='black', grid=False)
ax.set_xlabel('Жанры игр')
ax.set_xticklabels(ax.get_xticklabels(), rotation=0)
ax.legend(['Медианные общие продажи, млн. копий'])
ax.set_title('За период с 2014 по 2016 год')
plt.show()
```


    
![png](output_138_0.png)
    


<font color=blue>Безоговорочным лидером в последние годы по количеству продаж копий игр можно считать такой жанр, как `Shooter`. Игры этого жанра, как правило, продаются полумиллионным тиражом. В пятерку также попали, хоть и с большим отставанием, - `Sports`, `Platform` (как они выжили?), `Fighting` и `Role-Playing`. Где-то в хвосте игры, у которых медитативный геймплей, которые требуют усидчивости и вдумчивости - `Strategy`, `Puzzle`. А также внезапно `Adventure`. 
На первый взгляд кажется, что, за исключением шутеров, распределение продаж довольно равномерное, и разница, например, между вторым (`Sports`) и девятым (`Racing`) местом в 90 тысяч копий выглядит незначительной. Однако, учитывая итак небольшой объем продаж игр этих жанров, это разница в 2 раза.</font> 


```python
# для точности:
n_df = df_actual_2014_2016.groupby('genre')['total_sales'].median().sort_values(ascending=False)
#n_df
print('Разница в продажах спортивных и гоночных игр (в млн. копий): ' + str(n_df[1] - n_df[8]))
```

    Разница в продажах спортивных и гоночных игр (в млн. копий): 0.09
    

## Портрет пользователя каждого региона

### Самые популярные платформы (ТОП-5)

<font color=red>Это бы все через функцию делать...но займусь этим после сдачи=)</font>


```python
# создадим отдельный датафрейм с суммарными продажами по отдельным регионам сгруппированным по платформам  
df_actual_2014_2016_groupby_platforms = df_actual_2014_2016.groupby('platform')['na_sales', 'eu_sales', 'jp_sales'].sum()

# создадим словарь с ТОП-5 платформами каждого региона
regions_sales = ['na_sales', 'eu_sales', 'jp_sales']
dict_keys = ['na_top', 'eu_top', 'jp_top']
top_platforms_dict = {}
for i in range(0, len(regions_sales)):
    top_platforms_dict[dict_keys[i]] = df_actual_2014_2016_groupby_platforms.sort_values(by=regions_sales[i], ascending=False).index[:5].tolist()
top_platforms_dict
```




    {'na_top': ['PS4', 'XOne', 'X360', '3DS', 'PS3'],
     'eu_top': ['PS4', 'XOne', 'PS3', 'PC', '3DS'],
     'jp_top': ['3DS', 'PS4', 'PSV', 'PS3', 'WiiU']}




```python
# проведем категоризацию платформ по каждому региону
for i in df_actual_2014_2016['platform'].unique():
    if i in top_platforms_dict['na_top']:
        df_actual_2014_2016.loc[df_actual_2014_2016['platform'] == i, 'na_top_platforms'] = i
    else:
        df_actual_2014_2016.loc[df_actual_2014_2016['platform'] == i, 'na_top_platforms'] = 'Other'
    
    if i in top_platforms_dict['eu_top']:
        df_actual_2014_2016.loc[df_actual_2014_2016['platform'] == i, 'eu_top_platforms'] = i
    else:
        df_actual_2014_2016.loc[df_actual_2014_2016['platform'] == i, 'eu_top_platforms'] = 'Other'
        
    if i in top_platforms_dict['jp_top']:
        df_actual_2014_2016.loc[df_actual_2014_2016['platform'] == i, 'jp_top_platforms'] = i
    else:
        df_actual_2014_2016.loc[df_actual_2014_2016['platform'] == i, 'jp_top_platforms'] = 'Other'
```


```python
# проверим, правильно ли получилось на XOne и WiiU
df_actual_2014_2016[(df_actual_2014_2016['platform'] == 'XOne') | (df_actual_2014_2016['platform'] == 'WiiU')].head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
      <th>genre</th>
      <th>na_sales</th>
      <th>eu_sales</th>
      <th>jp_sales</th>
      <th>other_sales</th>
      <th>critic_score</th>
      <th>user_score</th>
      <th>rating</th>
      <th>total_sales</th>
      <th>na_top_platforms</th>
      <th>eu_top_platforms</th>
      <th>jp_top_platforms</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>99</th>
      <td>Call of Duty: Black Ops 3</td>
      <td>XOne</td>
      <td>2015</td>
      <td>Shooter</td>
      <td>4.59</td>
      <td>2.11</td>
      <td>0.01</td>
      <td>0.68</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>7.39</td>
      <td>XOne</td>
      <td>XOne</td>
      <td>Other</td>
    </tr>
    <tr>
      <th>110</th>
      <td>Mario Kart 8</td>
      <td>WiiU</td>
      <td>2014</td>
      <td>Racing</td>
      <td>3.15</td>
      <td>2.15</td>
      <td>1.28</td>
      <td>0.51</td>
      <td>88.0</td>
      <td>9.1</td>
      <td>E</td>
      <td>7.09</td>
      <td>Other</td>
      <td>Other</td>
      <td>WiiU</td>
    </tr>
    <tr>
      <th>165</th>
      <td>Grand Theft Auto V</td>
      <td>XOne</td>
      <td>2014</td>
      <td>Action</td>
      <td>2.81</td>
      <td>2.19</td>
      <td>0.00</td>
      <td>0.47</td>
      <td>97.0</td>
      <td>7.9</td>
      <td>M</td>
      <td>5.47</td>
      <td>XOne</td>
      <td>XOne</td>
      <td>Other</td>
    </tr>
    <tr>
      <th>179</th>
      <td>Call of Duty: Advanced Warfare</td>
      <td>XOne</td>
      <td>2014</td>
      <td>Shooter</td>
      <td>3.22</td>
      <td>1.55</td>
      <td>0.01</td>
      <td>0.48</td>
      <td>81.0</td>
      <td>5.4</td>
      <td>M</td>
      <td>5.26</td>
      <td>XOne</td>
      <td>XOne</td>
      <td>Other</td>
    </tr>
    <tr>
      <th>216</th>
      <td>Super Smash Bros. for Wii U and 3DS</td>
      <td>WiiU</td>
      <td>2014</td>
      <td>Fighting</td>
      <td>2.60</td>
      <td>1.08</td>
      <td>0.81</td>
      <td>0.38</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>4.87</td>
      <td>Other</td>
      <td>Other</td>
      <td>WiiU</td>
    </tr>
  </tbody>
</table>
</div>




```python
fig, axes = plt.subplots(1, 3, figsize=(20, 7))
# subplot 1
ax = df_actual_2014_2016.groupby('na_top_platforms')['na_sales'].sum().plot(kind='pie', 
                                                                              ax=axes[0],
                                                                              colors=sns.color_palette('husl', 6),
                                                                              autopct='%.1f%%',
                                                                              shadow=True, 
                                                                              explode=(0.05, 0.05, 0.05, 0.15, 0.05, 0.05), 
                                                                              wedgeprops={'lw':1, 'ls':'-','edgecolor':"k"}, 
                                                                              rotatelabels=False)
ax.set_title('ТОП-5 платформ Северной Америки по продажам копий игр')
ax.set_ylabel('')

# subplot 2
ax = df_actual_2014_2016.groupby('eu_top_platforms')['eu_sales'].sum().plot(kind='pie', 
                                                                              ax=axes[1],
                                                                              colors=sns.color_palette('husl', 6),
                                                                              autopct='%.1f%%',
                                                                              pctdistance=0.7,
                                                                              shadow=True,
                                                                              explode=(0.05, 0.05, 0.05, 0.05, 0.15, 0.05), 
                                                                              wedgeprops={'lw':1, 'ls':'-','edgecolor':"k"}, 
                                                                              rotatelabels=False)
ax.set_title('ТОП-5 платформ Европы по продажам копий игр')
ax.set_ylabel('')

# subplot 3
ax = df_actual_2014_2016.groupby('jp_top_platforms')['jp_sales'].sum().plot(kind='pie', 
                                                                              ax=axes[2],
                                                                              colors=sns.color_palette('husl', 6),
                                                                              autopct='%.1f%%',
                                                                              pctdistance=0.7,
                                                                              shadow=True,
                                                                              explode=(0.15, 0.05, 0.05, 0.05, 0.05, 0.05), 
                                                                              wedgeprops={'lw':1, 'ls':'-','edgecolor':"k"}, 
                                                                              rotatelabels=False)
ax.set_title('ТОП-5 платформ Японии по продажам копий игр')
ax.set_ylabel('')

plt.show()
```


    
![png](output_147_0.png)
    


Два мастодонта игрового рынка последних лет в Северной Америке и Европе - консоли `PS4` и `XOne`. На двоих они занимают больше двух третей игрового рынка (63,3% - в Северной Америке, 65,1% - в Европе). Microsoft настолько сильно проиграла конкурентную гонку в этом поколении, что даже на внутреннем рынке не смогла занять первое место по продажам игр на свою консоль, в то время как в прошлом поколении у нее это получилось. Также стоит выделить в обоих регионах платформу `3DS`, а в Европе еще и `PC`. Они тоже входят в топ 5. Рассматривать консоли `PS3` и `X360` в планах на 2017 год нецелесообразно. Им на смену пришло новое поколение, а значит довольно быстро они уйдут в прошлое.  
Не зря азиатский рынок всегда просчитывается отдельно. Там все иначе: тотально доминируют "свои" консоли, занимая 99% рынка. При этом довольно большую часть занимают портативные консоли, такие как `3DS` и `PSV` (на двоих две трети рынка). 

### Самые популярные жанры (ТОП-5)


```python
# создадим отдельный датафрейм с суммарными продажами по отдельным регионам сгруппированным по жанрам игр  
df_actual_2014_2016_groupby_genre = df_actual_2014_2016.groupby('genre')['na_sales', 'eu_sales', 'jp_sales'].sum()

# создадим словарь с ТОП-5 платформами каждого региона
regions_sales = ['na_sales', 'eu_sales', 'jp_sales']
top_genre_dict = {}
for i in range(0, len(regions_sales)):
    top_genre_dict[dict_keys[i]] = df_actual_2014_2016_groupby_genre.sort_values(by=regions_sales[i], ascending=False).index[:5].tolist()
top_genre_dict
```




    {'na_top': ['Shooter', 'Action', 'Sports', 'Role-Playing', 'Misc'],
     'eu_top': ['Action', 'Shooter', 'Sports', 'Role-Playing', 'Racing'],
     'jp_top': ['Role-Playing', 'Action', 'Fighting', 'Misc', 'Shooter']}




```python
# проведем категоризацию жарнов игр по каждому региону
for i in df_actual_2014_2016['genre'].unique():
    if i in top_genre_dict['na_top']:
        df_actual_2014_2016.loc[df_actual_2014_2016['genre'] == i, 'na_top_genre'] = i
    else:
        df_actual_2014_2016.loc[df_actual_2014_2016['genre'] == i, 'na_top_genre'] = 'Other'
    
    if i in top_genre_dict['eu_top']:
        df_actual_2014_2016.loc[df_actual_2014_2016['genre'] == i, 'eu_top_genre'] = i
    else:
        df_actual_2014_2016.loc[df_actual_2014_2016['genre'] == i, 'eu_top_genre'] = 'Other'
        
    if i in top_genre_dict['jp_top']:
        df_actual_2014_2016.loc[df_actual_2014_2016['genre'] == i, 'jp_top_genre'] = i
    else:
        df_actual_2014_2016.loc[df_actual_2014_2016['genre'] == i, 'jp_top_genre'] = 'Other'
```


```python
fig, axes = plt.subplots(1, 3, figsize=(20, 7))
# subplot 1
ax = df_actual_2014_2016.groupby('na_top_genre')['na_sales'].sum().plot(kind='pie', 
                                                                              ax=axes[0],
                                                                              colors=sns.color_palette('husl', 6),
                                                                              autopct='%.1f%%',
                                                                              shadow=True, 
                                                                              explode=(0.05, 0.05, 0.05, 0.05, 0.15, 0.05), 
                                                                              wedgeprops={'lw':1, 'ls':'-','edgecolor':"k"}, 
                                                                              rotatelabels=False)
ax.set_title('ТОП-5 жанров игр Северной Америки по продажам копий')
ax.set_ylabel('')

# subplot 2
ax = df_actual_2014_2016.groupby('eu_top_genre')['eu_sales'].sum().plot(kind='pie', 
                                                                              ax=axes[1],
                                                                              colors=sns.color_palette('husl', 6),
                                                                              autopct='%.1f%%',
                                                                              pctdistance=0.7,
                                                                              shadow=True,
                                                                              explode=(0.15, 0.05, 0.05, 0.05, 0.05, 0.05), 
                                                                              wedgeprops={'lw':1, 'ls':'-','edgecolor':"k"}, 
                                                                              rotatelabels=False)
ax.set_title('ТОП-5 жанров игр Европы по продажам копий')
ax.set_ylabel('')

# subplot 3
ax = df_actual_2014_2016.groupby('jp_top_genre')['jp_sales'].sum().plot(kind='pie', 
                                                                              ax=axes[2],
                                                                              colors=sns.color_palette('husl', 6),
                                                                              autopct='%.1f%%',
                                                                              pctdistance=0.7,
                                                                              shadow=True,
                                                                              explode=(0.05, 0.05, 0.05, 0.05, 0.15, 0.05), 
                                                                              wedgeprops={'lw':1, 'ls':'-','edgecolor':"k"}, 
                                                                              rotatelabels=False)
ax.set_title('ТОП-5 жанров игр Японии по продажам копий')
ax.set_ylabel('')

plt.show()
```


    
![png](output_152_0.png)
    


Три самых популярных жанра игр в Северной Америке и Европе - это `Shooter`, `Action` и `Sports`. В Северной Америке немного лидирует `Shooter`, в Европе - `Action`, но в общем и целом на эти три жанра приходится практически 70% игрового рынка в обоих регионах. Далее идут ролевые игры `Role-Playing`, а замыкает 5 лидеров в Северной Америке - `Misc`, а в Европе - `Racing`. 
В Японии, конечно, все по-другому. Исторически там популярнее всего ролёвки `Role-Playing` (треть рынка), на втором месте экшен игры `Action` (другая треть), далее в порядке убывания идут `Fighting`, `Misc` и `Shooter`. 

### Влияние рейтинга ESRB на продажи в отдельном регионе


```python
fig, axes = plt.subplots(1, 3, figsize=(20, 7))
# subplot 1
ax = df_actual_2014_2016.query('rating != "no rating" and rating != "RP"').groupby('rating')['na_sales'].sum().plot(kind='pie', 
                                                                              ax=axes[0],
                                                                              colors=sns.color_palette('husl', 6),
                                                                              autopct='%.1f%%',
                                                                              shadow=True, 
                                                                              explode=(0.05, 0.05, 0.15, 0.05), 
                                                                              wedgeprops={'lw':1, 'ls':'-','edgecolor':"k"}, 
                                                                              rotatelabels=False)
ax.set_title('Влияние рейтинга игры на ее продажи в Северной Америке')
ax.set_ylabel('')

# subplot 2
ax = df_actual_2014_2016.query('rating != "no rating" and rating != "RP"').groupby('rating')['eu_sales'].sum().plot(kind='pie', 
                                                                              ax=axes[1],
                                                                              colors=sns.color_palette('husl', 6),
                                                                              autopct='%.1f%%',
                                                                              pctdistance=0.7,
                                                                              shadow=True,
                                                                              explode=(0.05, 0.05, 0.15, 0.05), 
                                                                              wedgeprops={'lw':1, 'ls':'-','edgecolor':"k"}, 
                                                                              rotatelabels=False)
ax.set_title('Влияние рейтинга игры на ее продажи в Европе')
ax.set_ylabel('')

# subplot 3
ax = df_actual_2014_2016.query('rating != "no rating" and rating != "RP"').groupby('rating')['jp_sales'].sum().plot(kind='pie', 
                                                                              ax=axes[2],
                                                                              colors=sns.color_palette('husl', 6),
                                                                              autopct='%.1f%%',
                                                                              pctdistance=0.7,
                                                                              shadow=True,
                                                                              explode=(0.05, 0.05, 0.05, 0.15), 
                                                                              wedgeprops={'lw':1, 'ls':'-','edgecolor':"k"}, 
                                                                              rotatelabels=False)
ax.set_title('Влияние рейтинга игры на ее продажи в Японии')
ax.set_ylabel('')

plt.show()
```


    
![png](output_155_0.png)
    



```python
df_actual_2014_2016[df_actual_2014_2016['rating'] == 'RP']
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
      <th>genre</th>
      <th>na_sales</th>
      <th>eu_sales</th>
      <th>jp_sales</th>
      <th>other_sales</th>
      <th>critic_score</th>
      <th>user_score</th>
      <th>rating</th>
      <th>total_sales</th>
      <th>na_top_platforms</th>
      <th>eu_top_platforms</th>
      <th>jp_top_platforms</th>
      <th>na_top_genre</th>
      <th>eu_top_genre</th>
      <th>jp_top_genre</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>



Одна игра с еще не присвоенным рейтингом. Думаю, ее можно не учитывать.


```python
fig, axes = plt.subplots(1, 3, figsize=(20, 7))
# subplot 1
ax = df_actual_2014_2016.query('rating != "RP"').groupby('rating')['na_sales'].sum().plot(kind='pie', 
                                                                              ax=axes[0],
                                                                              colors=sns.color_palette('husl', 6),
                                                                              autopct='%.1f%%',
                                                                              shadow=True, 
                                                                              explode=(0.05, 0.05, 0.15, 0.05, 0.05), 
                                                                              wedgeprops={'lw':1, 'ls':'-','edgecolor':"k"}, 
                                                                              rotatelabels=False)
ax.set_title('Влияние рейтинга игры на ее продажи в Северной Америке')
ax.set_ylabel('')

# subplot 2
ax = df_actual_2014_2016.query('rating != "RP"').groupby('rating')['eu_sales'].sum().plot(kind='pie', 
                                                                              ax=axes[1],
                                                                              colors=sns.color_palette('husl', 6),
                                                                              autopct='%.1f%%',
                                                                              pctdistance=0.7,
                                                                              shadow=True,
                                                                              explode=(0.05, 0.05, 0.15, 0.05, 0.05), 
                                                                              wedgeprops={'lw':1, 'ls':'-','edgecolor':"k"}, 
                                                                              rotatelabels=False)
ax.set_title('Влияние рейтинга игры на ее продажи в Европе')
ax.set_ylabel('')

# subplot 3
ax = df_actual_2014_2016.query('rating != "RP"').groupby('rating')['jp_sales'].sum().plot(kind='pie', 
                                                                              ax=axes[2],
                                                                              colors=sns.color_palette('husl', 6),
                                                                              autopct='%.1f%%',
                                                                              pctdistance=0.7,
                                                                              shadow=True,
                                                                              explode=(0.05, 0.05, 0.05, 0.05, 0.15), 
                                                                              wedgeprops={'lw':1, 'ls':'-','edgecolor':"k"}, 
                                                                              rotatelabels=False)
ax.set_title('Влияние рейтинга игры на ее продажи в Японии')
ax.set_ylabel('')

plt.show()
```


    
![png](output_158_0.png)
    



```python
df_actual_2014_2016[df_actual_2014_2016['rating'] == 'no rating']
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>platform</th>
      <th>year_of_release</th>
      <th>genre</th>
      <th>na_sales</th>
      <th>eu_sales</th>
      <th>jp_sales</th>
      <th>other_sales</th>
      <th>critic_score</th>
      <th>user_score</th>
      <th>rating</th>
      <th>total_sales</th>
      <th>na_top_platforms</th>
      <th>eu_top_platforms</th>
      <th>jp_top_platforms</th>
      <th>na_top_genre</th>
      <th>eu_top_genre</th>
      <th>jp_top_genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31</th>
      <td>Call of Duty: Black Ops 3</td>
      <td>PS4</td>
      <td>2015</td>
      <td>Shooter</td>
      <td>6.03</td>
      <td>5.86</td>
      <td>0.36</td>
      <td>2.38</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>14.63</td>
      <td>PS4</td>
      <td>PS4</td>
      <td>PS4</td>
      <td>Shooter</td>
      <td>Shooter</td>
      <td>Shooter</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Pokemon Omega Ruby/Pokemon Alpha Sapphire</td>
      <td>3DS</td>
      <td>2014</td>
      <td>Role-Playing</td>
      <td>4.35</td>
      <td>3.49</td>
      <td>3.10</td>
      <td>0.74</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>11.68</td>
      <td>3DS</td>
      <td>3DS</td>
      <td>3DS</td>
      <td>Role-Playing</td>
      <td>Role-Playing</td>
      <td>Role-Playing</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Star Wars Battlefront (2015)</td>
      <td>PS4</td>
      <td>2015</td>
      <td>Shooter</td>
      <td>2.99</td>
      <td>3.49</td>
      <td>0.22</td>
      <td>1.28</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>7.98</td>
      <td>PS4</td>
      <td>PS4</td>
      <td>PS4</td>
      <td>Shooter</td>
      <td>Shooter</td>
      <td>Shooter</td>
    </tr>
    <tr>
      <th>96</th>
      <td>Super Smash Bros. for Wii U and 3DS</td>
      <td>3DS</td>
      <td>2014</td>
      <td>Fighting</td>
      <td>3.27</td>
      <td>1.37</td>
      <td>2.43</td>
      <td>0.48</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>7.55</td>
      <td>3DS</td>
      <td>3DS</td>
      <td>3DS</td>
      <td>Other</td>
      <td>Other</td>
      <td>Fighting</td>
    </tr>
    <tr>
      <th>99</th>
      <td>Call of Duty: Black Ops 3</td>
      <td>XOne</td>
      <td>2015</td>
      <td>Shooter</td>
      <td>4.59</td>
      <td>2.11</td>
      <td>0.01</td>
      <td>0.68</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>7.39</td>
      <td>XOne</td>
      <td>XOne</td>
      <td>Other</td>
      <td>Shooter</td>
      <td>Shooter</td>
      <td>Shooter</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>16703</th>
      <td>Strawberry Nauts</td>
      <td>PSV</td>
      <td>2016</td>
      <td>Adventure</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>0.01</td>
      <td>Other</td>
      <td>Other</td>
      <td>PSV</td>
      <td>Other</td>
      <td>Other</td>
      <td>Other</td>
    </tr>
    <tr>
      <th>16707</th>
      <td>Aiyoku no Eustia</td>
      <td>PSV</td>
      <td>2014</td>
      <td>Misc</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>0.01</td>
      <td>Other</td>
      <td>Other</td>
      <td>PSV</td>
      <td>Misc</td>
      <td>Other</td>
      <td>Misc</td>
    </tr>
    <tr>
      <th>16710</th>
      <td>Samurai Warriors: Sanada Maru</td>
      <td>PS3</td>
      <td>2016</td>
      <td>Action</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>0.01</td>
      <td>PS3</td>
      <td>PS3</td>
      <td>PS3</td>
      <td>Action</td>
      <td>Action</td>
      <td>Action</td>
    </tr>
    <tr>
      <th>16712</th>
      <td>Haitaka no Psychedelica</td>
      <td>PSV</td>
      <td>2016</td>
      <td>Adventure</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>0.01</td>
      <td>Other</td>
      <td>Other</td>
      <td>PSV</td>
      <td>Other</td>
      <td>Other</td>
      <td>Other</td>
    </tr>
    <tr>
      <th>16714</th>
      <td>Winning Post 8 2016</td>
      <td>PSV</td>
      <td>2016</td>
      <td>Simulation</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.01</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>no rating</td>
      <td>0.01</td>
      <td>Other</td>
      <td>Other</td>
      <td>PSV</td>
      <td>Other</td>
      <td>Other</td>
      <td>Other</td>
    </tr>
  </tbody>
</table>
<p>750 rows × 18 columns</p>
</div>



<font color=blue>В Северной Америке и Европе практически идентичная картина: треть рынка занимают игры с рейтингом `M`, т.е. для лиц старше 17 лет. В таких играх возможно реалистичное насилие, ненормативная лексика, употребление табака, алкоголя или запрещенных наркотиков (как сказал бы типичный стример Twitch - осуждаю!).</font>
    
<font color=blue>На втором месте в обоих регионах игры без рейтинга. Сложно сказать, с чем связано его отсутствие. Среди таких игр очень много и крупных релизов, которые не могли попасть на прилавки магазинов, не получив рейтинга (Call of Duty: Black Ops 3, Star Wars Battlefront (2015). Возможно, если игра не выходила в США или Канаде, то рейтинг ей не присваивался ([ESRB присваивает рейтинг играм только в этих странах](https://ru.wikipedia.org/wiki/Entertainment_Software_Rating_Board), но среди "безрейтинговых" игр есть и те, что выходили в этих странах.</font>  
    
<font color=blue>Около пятой части рынков занимают игры с рейтингом `E`, подходящие для любого возраста.</font>
    
<font color=blue>Рейтинг `T` (подходят для лиц старше 13 лет (чуть менее реалистичные сцены насилия 🤔)), а также рейтинг `E10+` (старше 10 лет) занимают примерно по 10% рынка каждый. </font>

<font color=blue>Рейтинги игр в японии расположились следующим образом:</font>  
<font color=blue>1. Игры без рейтинга - 61.2%</font>   
<font color=blue>2. `T` - 15.8%</font>  
<font color=blue>3. `E` - 9.6%</font>    
<font color=blue>4. `M` - 8.6%</font>  
<font color=blue>5. `E10+` - 4.8%</font>    

<font color=blue>Не удивительно преобладание игр без рейтинга, потому что большинство японских игр выходят только на отечественный рынок (точнее на азиатский), поэтому не получают рейтинга в США и Канаде. Остальное распределение тоже довольно понятно: на рынке Японии с огромным перевесом лидируют азиатские консоли, а игры на них, как правило, семейные с довольно детской графикой (привет техническим мощностям). </font>

## Проверка гипотез

### Проверка первой гипотезы

**Гипотеза: средние пользовательские оценки платформ `Xbox One` и `PC` одинаковые**

$H_0$ (нулевая гипотеза): средние пользовательские оценки платформ `Xbox One` и `PC` одинаковые.  
$H_1$ (альтернативная гипотеза): средние пользовательские оценки платформ `Xbox One` и `PC` отличаются.  

Для проверки гипотез воспользуемся t-критением Стьюдента, поскольку исследуемые выборки независимы.


```python
# критический уровень статистической значимости = 0.05
alpha = .05

results_1 = st.ttest_ind(df_actual_2014_2016[(df_actual_2014_2016['platform'] == 'XOne') & \
                                             (df_actual_2014_2016['user_score'] >= 0)]['user_score'], 
                                  df_actual_2014_2016[(df_actual_2014_2016['platform'] == 'PC') & \
                                                      (df_actual_2014_2016['user_score'] >= 0)]['user_score'])
print('p-значение: ', results_1.pvalue)
if results_1.pvalue < alpha:
    print('Отвергаем нулевую гипотезу')
else:
    print('Не можем отвергнуть нулевую гипотезу')
```

    p-значение:  0.10450507919348415
    Не можем отвергнуть нулевую гипотезу
    

По результатам проверки гипотез выявлено, что средние пользовательские оценки платформ `Xbox One` и `PC` одинаковые.

### Проверка второй гипотезы

**Средние пользовательские рейтинги жанров `Action` и `Sports` разные.**

$H_0$ (нулевая гипотеза): средние пользовательские оценки жанров `Action` и `Sports` одинаковые.  
$H_1$ (альтернативная гипотеза): средние пользовательские оценки жанров `Action` и `Sports` отличаются.  

Для проверки гипотез опять воспользуемся t-критением Стьюдента, поскольку исследуемые выборки независимы.


```python
# критический уровень статистической значимости = 0.05
alpha = .05

results_2 = st.ttest_ind(df_actual_2014_2016[(df_actual_2014_2016['genre'] == 'Action') & \
                                             (df_actual_2014_2016['user_score'] >= 0)]['user_score'], 
                                  df_actual_2014_2016[(df_actual_2014_2016['genre'] == 'Sports') & \
                                                      (df_actual_2014_2016['user_score'] >= 0)]['user_score'])
print('p-значение: ', results_1.pvalue)
if results_2.pvalue < alpha:
    print('Отвергаем нулевую гипотезу')
else:
    print('Не можем отвергнуть нулевую гипотезу')
```

    p-значение:  0.10450507919348415
    Отвергаем нулевую гипотезу
    

По результатам проверки гипотез выявлено, что средние пользовательские оценки жанров `Action` и `Sports` разные.

## Общие выводы

По результатам исследования можно сделать следующие выводы: 
1. В последние годы объем игрового рынка сильно уменьшился (а может и данные у нас кривые) Так, например, в 2008 году вышло порядка 1450 игр, в то время, как уже в 2012 году эта цифра уменьшилась чуть больше, чем вдвое, до 500-600 тайтлов. Возможно на это дело повлияло то, что с развитием технологий и мощностей консолей, повышаются и запросы игроков в плане графики, оптимизации, сюжета, кат-сцен, продолжительности и наполненности игры, что, в свою очередь, требует от разработчиков больше времени, т.е. развитие технологий повлекло за собой увеличение цикла разработки игр. 
2. В среднем жизненный цикл игровой платформы длится около 10 лет.
3. Наиболее перспективными платформами на 2017 год являются `PS4` и `XOne`. Они в самом начале своего жизненного цикла, а значит вероятность, что появятся новые платформы, которые сместят их с лидирующих позиций, крайне мала. Можно также присмотреться к консоли `3DS` - это нишевый продукт, наиболее популярный в азиатском (Японском) регионе, но, учитывая размер этого самого азиатского региона, ставка на данную консоль не выглядит как совсем уж коммерческий провал. По аналогичным критериям можно выделить и платформы WiiU и PSV. Хоть продажи игр на эти платформы не столь высоки и находятся на плато, азиатские консоли довольно живучие, ставка в играх, выходящих на этих консолях, делается на геймплей, а не на графику (поэтому они и такие живучие), вследствие чего они могут еще долго приносить пусть и не растущий, но стабильный доход.  
4. За последние годы в лидеры по продажам копий игр выбился такой жанр, как шутеры. Далее, уже с большим отставанием, идут все остальные шанры. Наименее привлекательными в плане цифр продаж являются жанры, которые требуют большой усидчивости (Puzzle, Strategy). На удивление, популярность жанра Adventure хуже, чем всех остальных. 
5. В среднем игроки в Северной Америке и Европе не сильно отличаются по своим игровым вкусовым предпочтениям, в то время, как Японские игроки имеют совершенно иные вкусы. Поэтому для выработки стратегии на 2017 год необходимо брать во внимание и учитывать особенности двух среднестатистических игроков. Так, например, чтобы понравится "западному" игроку игра должна быть экшеном или шутером с соответствующим рейтингом (от `T` и выше) либо же спортивным симулятором. "Восточному" же геймер, помимо экшен игры, предпочитает ролевые. Не такая сильная любовь к шутерам автоматически понижает рейтинг игр до `T`. 
6. По большому проценту игр с отсутствующим рейтингом в Японии можно предположить, что любимые игры "восточного" геймера не так часто выходят за пределы азиатского рынка. Возможно издатели по каким-либо причинам просто этого не делают. Но, если такие попытки все-таки были и провалились, значит эти игры довольно специфические и не полюбились "западным" игрокам. Что тоже необходимо учитывать при разработке стратегии.
